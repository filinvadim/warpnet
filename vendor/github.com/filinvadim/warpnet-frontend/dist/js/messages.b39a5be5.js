"use strict";(self["webpackChunkwarpnet_frontend"]=self["webpackChunkwarpnet_frontend"]||[]).push([[871],{9591:function(e,t,s){s.r(t),s.d(t,{default:function(){return y}});var l=s(641),a=s(33),r=s(3751);const i={class:"flex container h-full w-full"},o={class:"flex-1 flex flex-col h-full"},c={class:"px-4 py-3 border-b border-lighter flex items-center"},n={key:0,class:"flex items-center"},d=["src"],h={class:"font-bold"},u={class:"text-sm text-dark"},f={class:"flex-1 overflow-y-auto p-4",ref:"messageContainer"},g={key:0,class:"flex justify-center"},m={class:"text-xs mt-1 text-gray-500"},p={class:"border-t border-lighter px-4 py-3"};function v(e,t,s,v,x,k){const w=(0,l.g2)("SideNav"),b=(0,l.g2)("router-link"),y=(0,l.g2)("Loader"),L=(0,l.gN)("linkify");return(0,l.uX)(),(0,l.CE)("div",i,[(0,l.bF)(w),(0,l.Lk)("div",o,[(0,l.Lk)("div",c,[(0,l.bF)(b,{to:{name:"Chats"},class:"mr-4"},{default:(0,l.k6)((()=>t[2]||(t[2]=[(0,l.Lk)("i",{class:"fas fa-arrow-left text-xl text-blue"},null,-1)]))),_:1}),x.chat?((0,l.uX)(),(0,l.CE)("div",n,[(0,l.Lk)("img",{src:this.otherUser.avatar||"default_profile.png",class:"w-10 h-10 rounded-full mr-3"},null,8,d),(0,l.Lk)("div",null,[(0,l.Lk)("p",h,(0,a.v_)(this.otherUser.username),1),(0,l.Lk)("p",u,"@"+(0,a.v_)(x.chat.other_user_id),1)])])):(0,l.Q3)("",!0)]),(0,l.Lk)("div",f,[x.loading?((0,l.uX)(),(0,l.CE)("div",g,[(0,l.bF)(y,{loading:x.loading},null,8,["loading"])])):((0,l.uX)(!0),(0,l.CE)(l.FK,{key:1},(0,l.pI)(x.messages,(t=>((0,l.uX)(),(0,l.CE)("div",{key:t.id,class:(0,a.C4)(["mb-4 flex",{"justify-end":t.owner_id===x.currentUserId}])},[(0,l.Lk)("div",{class:(0,a.C4)(["max-w-3/4 rounded-lg px-4 py-2",t.owner_id===x.currentUserId?"bg-blue text-white":"bg-lighter"])},[(0,l.bo)(((0,l.uX)(),(0,l.CE)("p",null,[(0,l.eW)((0,a.v_)(t.content),1)])),[[L]]),(0,l.Lk)("p",m,(0,a.v_)(e.$filters.timeago(t.created_at)),1)],2)],2)))),128))],512),(0,l.Lk)("div",p,[(0,l.Lk)("form",{onSubmit:t[1]||(t[1]=(0,r.D$)(((...e)=>k.sendMessage&&k.sendMessage(...e)),["prevent"])),class:"flex"},[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>x.newMessage=e),type:"text",placeholder:"Type a message...",class:"flex-1 rounded-full border border-lighter px-4 py-2 mr-2"},null,512),[[r.Jo,x.newMessage]]),t[3]||(t[3]=(0,l.Lk)("button",{type:"submit",class:"bg-blue text-white rounded-full px-6 py-2"}," Send ",-1))],32)])])])}s(4114);var x=s(6278),k={name:"Chat",components:{SideNav:(0,l.$V)((()=>s.e(466).then(s.bind(s,5085)))),Loader:(0,l.$V)((()=>s.e(587).then(s.bind(s,5587))))},data(){return{loading:!0,chat:null,messages:[],newMessage:"",messagesCursor:null,chatId:void 0,currentUserId:void 0,otherUser:void 0}},methods:{...(0,x.i0)("warpnet",["getChat","getProfile","sendDirectMessage"]),async loadChat(){try{this.chat=await this.getChat({chatId:this.chatId})}catch(e){console.error("Error loading chat:",e)}},async loadMessages(){try{const{messages:e,cursor:t}=await this.$store.dispatch("getMessages",{chatId:this.chatId,cursor:this.messagesCursor,limit:50});this.messages=[...e,...this.messages],this.messagesCursor=t,this.loading=!1}catch(e){console.error("Error loading messages:",e),this.loading=!1}},async sendMessage(){if(this.newMessage.trim())try{const e=await this.sendDirectMessage({chatId:this.chatId,text:this.newMessage});this.messages.push(e),this.newMessage="",this.scrollToBottom()}catch(e){console.error("Error sending message:",e)}},scrollToBottom(){this.$nextTick((()=>{const e=this.$refs.messageContainer;e.scrollTop=e.scrollHeight}))}},async created(){console.log("loading component:",this.$options.name),this.currentUserId=this.$route.params.id,this.chatId=this.$route.params.chatId;const e=this.chatId.split(":")[0];this.otherUser=await this.getProfile(e),await Promise.all([this.loadChat(),this.loadMessages()]),this.scrollToBottom()}},w=s(6262);const b=(0,w.A)(k,[["render",v]]);var y=b},4960:function(e,t,s){s.r(t),s.d(t,{default:function(){return E}});var l=s(641),a=s(33);const r={id:"app",class:"flex container h-full w-full"},i={class:"flex container h-full w-full"},o={class:"w-full sm:w-1/3 md:w-1/2 lg:w-1/2 h-full overflow-y-scroll no-scrollbar hidden md:block"},c={class:"px-5 py-3 border-b border-lighter flex"},n={key:0},d={key:0,class:"flex flex-col items-center justify-center w-full pt-10"},h={class:"cursor-pointer"},u=["onClick"],f={class:"flex-none mr-2 md:mr-4 pt-1"},g=["href"],m=["src"],p={class:"w-full truncate"},v={class:"flex items-center w-full"},x={class:"font-semibold"},k={class:"hidden md:block text-sm text-dark ml-2 truncate"},w={class:"text-sm text-dark ml-auto"},b={class:"pb-2 truncate"};function y(e,t,s,y,L,C){const M=(0,l.g2)("SideNav"),_=(0,l.g2)("Loader"),E=(0,l.g2)("NewMessageOverlay"),$=(0,l.gN)("linkify");return(0,l.uX)(),(0,l.CE)("div",r,[(0,l.Lk)("div",i,[(0,l.bF)(M),(0,l.Lk)("div",o,[(0,l.Lk)("div",c,[t[1]||(t[1]=(0,l.Lk)("h1",{class:"text-xl font-bold flex-1"},"Chats",-1)),t[2]||(t[2]=(0,l.Lk)("i",{class:"fas fa-cog text-xl text-blue cursor-pointer"},null,-1)),(0,l.Lk)("i",{onClick:t[0]||(t[0]=e=>C.newMessage()),class:"fas fa-plus-circle ml-3 text-xl text-blue cursor-pointer"})]),(0,l.bF)(_,{loading:L.loading},null,8,["loading"]),L.loading?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",n,[0===L.chats.length?((0,l.uX)(),(0,l.CE)("div",d,t[3]||(t[3]=[(0,l.Lk)("div",{class:"w-1/2 flex flex-col items-center justify-center"},[(0,l.Lk)("p",{class:"font-bold text-lg"},"No chats yet"),(0,l.Lk)("p",{class:"text-sm text-dark"}," Wait until someone starts a chat here. ")],-1)]))):(0,l.Q3)("",!0),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(L.chats,(t=>((0,l.uX)(),(0,l.CE)("div",{key:t.id},[(0,l.Lk)("div",h,[(0,l.Lk)("div",{class:"w-full p-2 pt-1 pb-1 md:p-4 md:pt-2 md:pb-2 border-b hover:bg-lightest flex",onClick:e=>C.selectChat(t)},[(0,l.Lk)("div",f,[(0,l.Lk)("a",{href:`#/${C.getUser(t.id).username}`},[(0,l.Lk)("img",{src:`${C.getUser(t.id).avatar||"default_profile.png"}`,class:"h-12 w-12 rounded-full flex-none"},null,8,m)],8,g)]),(0,l.Lk)("div",p,[(0,l.Lk)("div",v,[(0,l.Lk)("p",x,(0,a.v_)(C.getUser(t.id).username),1),(0,l.Lk)("p",k," @"+(0,a.v_)(C.getUser(t.id).id),1),(0,l.Lk)("p",w,(0,a.v_)(e.$filters.timeago(t.lastModified)),1)]),(0,l.bo)(((0,l.uX)(),(0,l.CE)("p",b,[(0,l.eW)((0,a.v_)(t.last_message),1)])),[[$]])])],8,u)])])))),128))]))]),t[4]||(t[4]=(0,l.Lk)("div",{class:"w-full border-l border-r border-lighter h-screen flex items-center justify-center"},[(0,l.Lk)("div",{class:"text-center"},[(0,l.Lk)("h2",{class:"text-2xl font-bold mb-4"},"Select a chat"),(0,l.Lk)("p",{class:"text-gray-600"},"Choose a chat from the list to start chatting")])],-1)),L.showNewMessageModal?((0,l.uX)(),(0,l.Wv)(E,{key:0,showNewMessageModal:L.showNewMessageModal,profileId:this.profileId,onSelected:C.selected},null,8,["showNewMessageModal","profileId","onSelected"])):(0,l.Q3)("",!0)])])}s(4114),s(8111),s(116);var L=s(6278),C={name:"Chats",components:{NewMessageOverlay:(0,l.$V)((()=>s.e(517).then(s.bind(s,517)))),Loader:(0,l.$V)((()=>s.e(587).then(s.bind(s,5587)))),SideNav:(0,l.$V)((()=>s.e(466).then(s.bind(s,5085))))},data(){return{loading:!0,showNewMessageModal:!1,chats:[],chatsCursor:"",profileId:"",chatUsers:new Map}},methods:{...(0,L.i0)("warpnet",["createChat","deleteChat","getChats","getProfile"]),newMessage(){this.showNewMessageModal=!0},getUser(e){return this.chatUsers.get(e)},async selectChat(e){this.$router.push({name:"Messages",params:{id:this.$route.params.id,chatId:e.id}})},async selected(e){if(!e.id)return;this.showNewMessageModal=!1;const t=this.chats.find((t=>t.other_user_id===e.id));if(t)await this.selectChat(t);else{const t=await this.createChat({otherUserId:e.id});t&&await this.selectChat(t)}},async loadChats(){try{const e=await this.getChats({limit:20,cursor:this.chatsCursor});for(const t of e.chats||[]){const e=await this.getProfile(t.other_user_id);this.chatUsers.set(t.id,e)}this.chats=[...this.chats,...e.chats],this.chatsCursor=e.cursor,this.loading=!1}catch(e){console.error("Error loading chats:",e),this.loading=!1}}},async created(){console.log("loading component:",this.$options.name),this.profileId=this.$route.params.id,await this.loadChats()}},M=s(6262);const _=(0,M.A)(C,[["render",y]]);var E=_},4686:function(e,t,s){s.r(t),s.d(t,{default:function(){return le}});var l=s(641),a=s(33),r=s(3751);const i={id:"app",class:"flex container h-full w-full"},o={class:"flex container h-full w-full"},c={class:"w-full sm:w-1/3 md:w-1/2 lg:w-1/2 h-full overflow-y-scroll no-scrollbar hidden md:block"},n={key:0},d={key:0,class:"flex flex-col items-center justify-center w-full pt-10"},h=["onClick"],u={class:"flex-none mr-2 md:mr-4 pt-1"},f=["href"],g=["src"],m={class:"w-full truncate"},p={class:"flex items-center w-full"},v={class:"font-semibold"},x={key:0,class:"hidden md:block text-sm text-dark ml-2 truncate"},k={class:"text-sm text-dark ml-auto"},w={class:"pb-2 truncate"},b={key:0,class:"w-full z-0 h-screen border-l border-r border-lighter overflow-y-scroll no-scrollbar relative flex flex-col items-center justify-center",style:{display:"grid","grid-template-rows":"53px auto"}},y={class:"flex flex-col items-center justify-center w-full"},L={class:"w-3/5"},C={class:"flex justify-start mt-5"},M={key:1,class:"w-full border-l border-r border-lighter h-screen",style:{display:"grid","grid-template-rows":"53px auto 53px"}},_={key:0,class:"flex-none mr-4"},E=["href"],$=["src"],N={class:"w-full flex flex-col"},I={class:"text-m font-bold flex-1"},U={class:"text-dark text-xs"},X={class:"w-full pt-5 overflow-y-scroll no-scrollbar",style:{display:"grid","grid-template-rows":"auto"}},S={class:"w-full px-5 flex flex-col justify-between"},T={class:"flex flex-col-reverse mt-1 h-full",style:{"min-height":"100%"}},P={ref:"scrollToMe"},j={key:0},Q={class:"flex justify-end"},D={class:"mr-2 py-3 px-4 bg-blue rounded-bl-3xl rounded-tl-3xl rounded-tr-xl text-white"},V={class:"flex justify-end w-full mb-4"},F={class:"text-xs text-dark mr-2"},O={key:1},A={class:"flex justify-start"},R={class:"flex-none mr-4"},W=["href"],H=["src"],J={class:"ml-2 py-3 px-4 bg-lighter rounded-br-3xl rounded-tr-3xl rounded-tl-xl text-black"},K={class:"flex items-center w-full mb-4"},B={class:"text-xs text-dark ml-14"},q={class:"bg-white px-5 p-3 border-t border-lighter flex w-full"},z=["disabled"],Y=["disabled"];function G(e,t,s,G,Z,ee){const te=(0,l.g2)("SideNav"),se=(0,l.g2)("Loader"),le=(0,l.g2)("NewMessageOverlay"),ae=(0,l.gN)("linkify"),re=(0,l.gN)("scroll");return(0,l.uX)(),(0,l.CE)("div",i,[(0,l.Lk)("div",o,[(0,l.bF)(te),(0,l.Lk)("div",c,[(0,l.Lk)("div",{class:"px-5 py-3 border-b border-lighter flex",onClick:t[1]||(t[1]=e=>ee.deselectAll())},[t[9]||(t[9]=(0,l.Lk)("h1",{class:"text-xl font-bold flex-1"},"Messages",-1)),t[10]||(t[10]=(0,l.Lk)("i",{class:"fas fa-cog text-xl text-blue cursor-pointer"},null,-1)),(0,l.Lk)("i",{onClick:t[0]||(t[0]=e=>ee.newMessage()),class:"fas fa-plus-circle ml-3 text-xl text-blue cursor-pointer"})]),(0,l.bF)(se,{loading:Z.loading},null,8,["loading"]),Z.loading?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",n,[0===Z.chats.length?((0,l.uX)(),(0,l.CE)("div",d,t[11]||(t[11]=[(0,l.Lk)("div",{class:"w-1/2 flex flex-col items-center justify-center"},[(0,l.Lk)("p",{class:"font-bold text-lg"},"No chats yet"),(0,l.Lk)("p",{class:"text-sm text-dark"}," Wait until someone starts a chat here. ")],-1)]))):(0,l.Q3)("",!0),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(Z.chats,(t=>((0,l.uX)(),(0,l.CE)("div",{key:t.id},[(0,l.Lk)("p",null,"ACTIVE: "+(0,a.v_)(JSON.stringify(Z.active))+" "+(0,a.v_)(JSON.stringify(t)),1),(0,l.Lk)("div",{class:(0,a.C4)(["cursor-pointer",Z.active&&Z.active.chat&&t.id===Z.active.chat.id?"border-r-2 border-blue":""])},[(0,l.Lk)("div",{class:"w-full p-2 pt-1 pb-1 md:p-4 md:pt-2 md:pb-2 border-b hover:bg-lightest flex",onClick:(0,r.D$)((e=>ee.selectChat(t)),["stop"])},[(0,l.Lk)("div",u,[Z.active&&Z.active.otherUser?((0,l.uX)(),(0,l.CE)("a",{key:0,href:`#/${Z.active.otherUser.username}`},[(0,l.Lk)("img",{src:`${Z.active.otherUser.avatar||"default_profile.png"}`,class:"h-12 w-12 rounded-full flex-none"},null,8,g)],8,f)):(0,l.Q3)("",!0)]),(0,l.Lk)("div",m,[(0,l.Lk)("div",p,[(0,l.Lk)("p",v,(0,a.v_)(t.other_user_id),1),Z.active&&Z.active.otherUser?((0,l.uX)(),(0,l.CE)("p",x," @"+(0,a.v_)(Z.active.otherUser.username||"Anonymous"),1)):(0,l.Q3)("",!0),(0,l.Lk)("p",k,(0,a.v_)(e.$filters.timeago(t.updated_at)),1)]),(0,l.bo)(((0,l.uX)(),(0,l.CE)("p",w,[(0,l.eW)((0,a.v_)(t.last_message),1)])),[[ae]])])],8,h)],2)])))),128))]))]),Z.loading||!Z.active?((0,l.uX)(),(0,l.CE)("div",b,[(0,l.Lk)("div",{class:(0,a.C4)(["top-0 left-0 w-full px-5 pt-1 pb-2 border-lighter flex bg-white",Z.active?"border-b":""])},[(0,l.Lk)("button",{onClick:t[2]||(t[2]=e=>ee.gotoHome()),class:"block md:hidden rounded-full mr-2 focus:outline-none hover:bg-lightblue"},t[12]||(t[12]=[(0,l.Lk)("i",{class:"fas fa-arrow-left text-blue"},null,-1)]))],2),(0,l.Lk)("div",y,[(0,l.Lk)("div",L,[t[13]||(t[13]=(0,l.Lk)("p",{class:"font-bold text-lg"},"You don’t have a message selected",-1)),t[14]||(t[14]=(0,l.Lk)("p",{class:"text-sm text-dark"}," This is where you’ll see messages from people you don’t follow. They won’t know you’ve seen the request until you accept it. ",-1)),(0,l.Lk)("div",C,[(0,l.Lk)("button",{onClick:t[3]||(t[3]=e=>ee.newMessage()),type:"button",class:"h-10 px-2 text-white font-semibold bg-blue hover:bg-darkblue rounded-full"}," New Message ")])])])])):(0,l.Q3)("",!0),!Z.loading&&Z.active?((0,l.uX)(),(0,l.CE)("div",M,[(0,l.Lk)("div",{class:"px-5 pt-1 pb-2 border-b border-lighter flex bg-white sticky",onClick:t[5]||(t[5]=e=>ee.deselectAll())},[(0,l.Lk)("button",{onClick:t[4]||(t[4]=e=>ee.gotoHome()),class:"block md:hidden rounded-full mr-2 focus:outline-none hover:bg-lightblue"},t[15]||(t[15]=[(0,l.Lk)("i",{class:"fas fa-arrow-left text-blue"},null,-1)])),Z.active&&Z.active.chat?((0,l.uX)(),(0,l.CE)("div",_,[(0,l.Lk)("a",{href:`#/${Z.active.chat.other_user_id}`},[Z.active&&Z.active.otherUser?((0,l.uX)(),(0,l.CE)("img",{key:0,src:`${Z.active.otherUser.avatar||"default_profile.png"}`,class:"flex-none w-6 h-6 rounded-full mt-2"},null,8,$)):(0,l.Q3)("",!0)],8,E)])):(0,l.Q3)("",!0),(0,l.Lk)("div",N,[(0,l.Lk)("h1",I,(0,a.v_)(Z.active.otherUser.username),1),(0,l.Lk)("p",U,"@"+(0,a.v_)(Z.active.chat.other_user_id),1)]),t[16]||(t[16]=(0,l.Lk)("i",{class:"fas fa-info-circle ml-3 text-xl text-blue mt-2 cursor-pointer"},null,-1))]),(0,l.bo)(((0,l.uX)(),(0,l.CE)("div",X,[(0,l.Lk)("div",S,[(0,l.Lk)("div",T,[(0,l.Lk)("div",P,null,512),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(Z.messages,(t=>((0,l.uX)(),(0,l.CE)("div",{key:t.id},[t.owner_id===this.ownerProfile.id?((0,l.uX)(),(0,l.CE)("div",j,[(0,l.Lk)("div",Q,[(0,l.Lk)("div",D,(0,a.v_)(t.text),1)]),(0,l.Lk)("div",V,[(0,l.Lk)("p",F,(0,a.v_)(e.$filters.time(t.created_at)),1)])])):(0,l.Q3)("",!0),!t.owner_id===this.ownerProfile.id?((0,l.uX)(),(0,l.CE)("div",O,[(0,l.Lk)("div",A,[(0,l.Lk)("div",R,[(0,l.Lk)("a",{href:`#/${t.other_user_id}`},[(0,l.Lk)("img",{src:`${Z.active.otherUser.avatar||"default_profile.png"}`,class:"object-cover h-8 w-8 rounded-full self-end"},null,8,H)],8,W)]),(0,l.Lk)("div",J,(0,a.v_)(t.text),1)]),(0,l.Lk)("div",K,[(0,l.Lk)("p",B,(0,a.v_)(e.$filters.time(t.created_at)),1)])])):(0,l.Q3)("",!0)])))),128))])])])),[[re,ee.loadMore,"top"]]),(0,l.Lk)("div",q,[(0,l.bo)((0,l.Lk)("input",{ref:"input",class:"pl-5 rounded-full w-full p-2 bg-lighter text-sm focus:bg-white focus:outline-none focus:ring-2 focus:ring-blue",placeholder:"Start a new message",type:"search","onUpdate:modelValue":t[6]||(t[6]=e=>Z.text=e),onKeyup:t[7]||(t[7]=(0,r.jR)((e=>ee.sendMessage()),["enter"])),disabled:Z.disabled},null,40,z),[[r.Jo,Z.text]]),(0,l.Lk)("button",{class:(0,a.C4)(["rounded-full focus:outline-none right-4 ml-4 w-8 h-8",""+(0===Z.text.length?"opacity-50 cursor-default":"hover:bg-lightblue")]),onClick:t[8]||(t[8]=e=>ee.sendMessage()),disabled:Z.disabled},t[17]||(t[17]=[(0,l.Lk)("i",{class:"fas fa-arrow-right text-xl text-blue"},null,-1)]),10,Y)])])):(0,l.Q3)("",!0),Z.showNewMessageModal?((0,l.uX)(),(0,l.Wv)(le,{key:2,showNewMessageModal:Z.showNewMessageModal,onSelected:ee.selected},null,8,["showNewMessageModal","onSelected"])):(0,l.Q3)("",!0)])])}s(4114),s(8111),s(7588);var Z=s(6278),ee={name:"Messages",components:{SideNav:(0,l.$V)((()=>s.e(466).then(s.bind(s,5085)))),Loader:(0,l.$V)((()=>s.e(587).then(s.bind(s,5587)))),NewMessageOverlay:(0,l.$V)((()=>s.e(517).then(s.bind(s,517))))},data(){return{loading:!1,text:"",disabled:!1,showNewMessageModal:!1,chats:[],chatsCursor:"",messages:[],messagesCursor:"",ownerProfile:void 0,active:{chat:{id:"Loading...",other_user_id:"Loading..."},otherUser:{avatar:null,username:"Loading..."}}}},methods:{...(0,Z.i0)("warpnet",["getOwnerProfile","getProfile","createChat","deleteChat","getChats","getDirectMessages","sendDirectMessage"]),newMessage(){this.showNewMessageModal=!0},gotoHome(){this.$router.push({name:"Home"})},sendMessage(){this.active&&this.active.chat.other_user_id&&0!==this.text.length&&(this.disabled=!0,this.sendDirectMessage({chatId:this.active.chat.id,text:this.text}).then((()=>{this.text="",this.disabled=!1,this.$nextTick((()=>{this.scrollToEnd()}))})))},scrollToEnd(){this.$nextTick((()=>{const e=this.$refs.scrollToMe;e&&e.scrollIntoView({behavior:"smooth"}),setTimeout((()=>this.$refs.input.focus()),500)}))},async selected(e){if(!this.ownerProfile.id||!e.id)return;this.showNewMessageModal=!1;const t=`${this.ownerProfile.id}:${e.id}`,s=`${e.id}:${this.ownerProfile.id}`;let l;this.chats.forEach((e=>{e.id!==t&&e.id!==s||(l=e)})),l||(l={id:t,other_user_id:e.id,owner_id:""}),await this.selectChat(l)},async selectChat(e){console.log("selectChat",JSON.stringify(e)),this.active={chat:e,otherUser:{username:"Loading...",avatar:null}};const[t,s]=await Promise.all([this.getProfile(e.other_user_id),this.getDirectMessages({chatId:e.id,limit:20,cursor:this.messagesCursor})]);this.active={chat:e,otherUser:t},this.messages=[...this.messages,...s.messages],this.messagesCursor=s.cursor,this.scrollToEnd()},deselectAll(){},async loadMore(){if(!this.active||!this.active.chat)return;const e=await this.getDirectMessages({chatId:this.active.chat.id,limit:20,cursor:this.messagesCursor}).catch((e=>{console.error(e)}));this.messages=[...this.messages,...e]}},async created(){this.loading=!0,console.log("loading component:",this.$options.name),this.ownerProfile=await this.getOwnerProfile();const e=await this.getChats({limit:20,cursor:this.chatsCursor});e&&0!==e.chats.length?(this.chats=e.chats,this.chatsCursor=e.cursor,this.loading=!1):console.error("No chats found.")}},te=s(6262);const se=(0,te.A)(ee,[["render",G]]);var le=se},116:function(e,t,s){var l=s(6518),a=s(2652),r=s(9306),i=s(8551),o=s(1767);l({target:"Iterator",proto:!0,real:!0},{find:function(e){i(this),r(e);var t=o(this),s=0;return a(t,(function(t,l){if(e(t,s++))return l(t)}),{IS_RECORD:!0,INTERRUPTED:!0}).result}})},7588:function(e,t,s){var l=s(6518),a=s(2652),r=s(9306),i=s(8551),o=s(1767);l({target:"Iterator",proto:!0,real:!0},{forEach:function(e){i(this),r(e);var t=o(this),s=0;a(t,(function(t){e(t,s++)}),{IS_RECORD:!0})}})}}]);
//# sourceMappingURL=messages.b39a5be5.js.map