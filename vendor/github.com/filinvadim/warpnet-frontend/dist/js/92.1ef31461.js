"use strict";(self["webpackChunkwarpnet_frontend"]=self["webpackChunkwarpnet_frontend"]||[]).push([[92],{5587:function(e,t,s){s.d(t,{A:function(){return d}});var l=s(641);const i={key:0,class:"flex items-center justify-center"};function r(e,t,s,r,o,a){return s.loading?((0,l.uX)(),(0,l.CE)("div",i,t[0]||(t[0]=[(0,l.Lk)("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"40px",height:"40px",viewBox:"0 0 40 40","enable-background":"new 0 0 40 40","xml:space":"preserve"},[(0,l.Lk)("path",{opacity:"0.2",fill:"#1da1f2",d:"M20.201,5.169c-8.254,0-14.946,6.692-14.946,14.946c0,8.255,6.692,14.946,14.946,14.946\n    s14.946-6.691,14.946-14.946C35.146,11.861,28.455,5.169,20.201,5.169z M20.201,31.749c-6.425,0-11.634-5.208-11.634-11.634\n    c0-6.425,5.209-11.634,11.634-11.634c6.425,0,11.633,5.209,11.633,11.634C31.834,26.541,26.626,31.749,20.201,31.749z"}),(0,l.Lk)("path",{fill:"#1da1f2",d:"M26.013,10.047l1.654-2.866c-2.198-1.272-4.743-2.012-7.466-2.012h0v3.312h0\n    C22.32,8.481,24.301,9.057,26.013,10.047z"},[(0,l.Lk)("animateTransform",{attributeType:"xml",attributeName:"transform",type:"rotate",from:"0 20 20",to:"360 20 20",dur:"0.5s",repeatCount:"indefinite"})])],-1)]))):(0,l.Q3)("",!0)}var o={name:"Loader",props:["loading"]},a=s(6262);const n=(0,a.A)(o,[["render",r]]);var d=n},945:function(e,t,s){s.d(t,{A:function(){return M}});var l=s(641),i=s(33),r=s(3751);const o={key:0,class:"fixed w-full h-full z-10 top-0 left-0 flex items-center justify-center"},a={class:"modal-main bg-white mx-auto rounded-lg z-0 overflow-y-auto",style:{width:"40%"}},n={class:"pl-1 pr-4 py-1 h-16 border-b-2 border-lightblue"},d={class:"flex flex-row mt-1 ml-4"},u={key:0,class:"border-l-2 border-r-2 border-white flex flex-col"},w={class:"p-3 flex flex-row"},h={class:"flex-none mr-4"},c=["src"],f={class:"w-full"},p={class:"flex items-center w-full"},k={class:"font-semibold"},g={class:"text-sm text-dark ml-2"},m={class:"text-sm text-dark ml-2"},x={class:"py-2"},b={class:"p-3 flex flex-row"},v={class:"flex-none mr-4"},y=["src"],L={class:"w-full mb-2"},C=["disabled"];function _(e,t,s,_,R,T){const E=(0,l.g2)("Tweet"),Q=(0,l.gN)("linkify");return s.showReplyOverlay?((0,l.uX)(),(0,l.CE)("div",o,[(0,l.Lk)("div",{class:"absolute w-full h-full bg-gray-900 opacity-50",onClick:t[0]||(t[0]=t=>e.$emit("update:showReplyOverlay",!1))}),(0,l.Lk)("div",a,[(0,l.Lk)("div",n,[(0,l.Lk)("div",d,[(0,l.Lk)("i",{onClick:t[1]||(t[1]=t=>e.$emit("update:showReplyOverlay",!1)),class:"fas fa-times text-blue text-2xl mb-8 mr-6 rounded-full bg-white p-2 px-3 hover:bg-lightblue cursor-pointer"})])]),s.profile?((0,l.uX)(),(0,l.CE)("div",u,[(0,l.Lk)("div",w,[(0,l.Lk)("div",h,[(0,l.Lk)("img",{src:`${s.profile.avatar||"default_profile.png"}`,class:"h-12 w-12 rounded-full flex-none",alt:"Profile avatar"},null,8,c)]),(0,l.Lk)("div",f,[(0,l.Lk)("div",p,[(0,l.Lk)("p",k,(0,i.v_)(s.tweet.user_id),1),(0,l.Lk)("p",g," @"+(0,i.v_)(s.tweet.username),1),t[4]||(t[4]=(0,l.Lk)("p",{class:"text-sm text-dark ml-2"},"·",-1)),(0,l.Lk)("p",m,(0,i.v_)(e.$filters.timeago(s.tweet.created_at)),1)]),(0,l.bo)(((0,l.uX)(),(0,l.CE)("p",x,[(0,l.eW)((0,i.v_)(s.tweet.text),1)])),[[Q]])])]),(0,l.Lk)("div",b,[(0,l.Lk)("div",v,[(0,l.Lk)("img",{src:`${R.ownerProfile.avatar||"default_profile.png"}`,class:"h-12 w-12 rounded-full flex-none",alt:"User avatar"},null,8,y)]),(0,l.Lk)("div",L,[(0,l.Lk)("form",{onSubmit:t[3]||(t[3]=(0,r.D$)(((...e)=>T.sendReply&&T.sendReply(...e)),["prevent"])),class:"w-full relative"},[(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":t[2]||(t[2]=e=>R.text=e),placeholder:"Tweet your reply",class:"w-full focus:outline-none mt-3 pb-3"},null,512),[[r.Jo,R.text]]),t[5]||(t[5]=(0,l.Lk)("div",null,[(0,l.Lk)("i",{class:"text-lg text-blue mr-4 far fa-image cursor-pointer"}),(0,l.Lk)("i",{class:"text-lg text-blue mr-4 fas fa-film cursor-pointer"}),(0,l.Lk)("i",{class:"text-lg text-blue mr-4 far fa-chart-bar cursor-pointer"}),(0,l.Lk)("i",{class:"text-lg text-blue mr-4 far fa-smile cursor-pointer"})],-1)),(0,l.Lk)("button",{type:"submit",class:(0,i.C4)(["h-10 px-4 text-white font-semibold bg-blue hover:bg-darkblue rounded-full absolute bottom-0 right-0",{"opacity-50 cursor-not-allowed":!R.text}]),disabled:!R.text}," Reply ",10,C)],32)])]),(0,l.Lk)("div",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(R.replies,(e=>((0,l.uX)(),(0,l.CE)("div",{key:e.id},[(0,l.bF)(E,{tweet:e},null,8,["tweet"])])))),128))])])):(0,l.Q3)("",!0)])])):(0,l.Q3)("",!0)}var R=s(6278),T=s(5481),E=s(652),Q={name:"ReplyOverlay",components:{Tweet:E.A,Retweet:T.A},props:{tweet:{type:Object,required:!0},profile:{type:Object,required:!0},showReplyOverlay:{type:Boolean,required:!0}},data(){return{text:"",ownerProfile:{},replies:[],repliesCursor:""}},methods:{...(0,R.i0)("warpnet",["getOwnerProfile","replyTweet","getReplies"]),async sendReply(){await this.replyTweet({rootId:this.tweet.root_id,parentId:this.tweet.id,text:this.text}),this.$emit("update:showReplyOverlay",!1)},handleKeyup(e){"Escape"===e.key&&this.$emit("update:showReplyOverlay",!1)}},async created(){this.ownerProfile=await this.getOwnerProfile();const e={rootId:this.tweet.root_id,parentId:this.tweet.id,limit:20,cursor:this.repliesCursor};this.replies=await this.getReplies(e),window.addEventListener("keyup",this.handleKeyup)},beforeDestroy(){window.removeEventListener("keyup",this.handleKeyup)}},$=s(6262);const O=(0,$.A)(Q,[["render",_]]);var M=O},5481:function(e,t,s){s.d(t,{A:function(){return X}});var l=s(641),i=s(33);const r={class:"w-full border-b hover:bg-lightest flex flex-col"},o={class:"pt-4 pl-4 flex flex-row"},a={class:"text-sm text-dark"};function n(e,t,s,n,d,u){const w=(0,l.g2)("Tweet");return(0,l.uX)(),(0,l.CE)("div",r,[(0,l.Lk)("div",o,[t[0]||(t[0]=(0,l.Lk)("div",{class:"w-12 mr-4 flex justify-end"},[(0,l.Lk)("i",{class:"text-sm pt-1 fas fa-retweet text-dark"})],-1)),(0,l.Lk)("p",a,(0,i.v_)(d.label),1)]),(0,l.bF)(w,{tweet:s.tweet},null,8,["tweet"])])}const d={key:0,class:"w-full p-2 pt-1 pb-1 md:p-4 md:pt-2 md:pb-2 border-b hover:bg-lightest flex"},u={class:"flex-none mr-2 md:mr-4 pt-1"},w=["src"],h={class:"w-full"},c={class:"flex items-center w-full"},f={class:"font-semibold"},p={class:"hidden md:block text-sm text-dark ml-2"},k={class:"text-sm text-dark ml-2"},g={key:0,class:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1"},m={class:"pb-2"},x={class:"flex w-full"},b={class:"flex items-center text-sm text-dark w-1/4"},v={key:0},y={class:"flex items-center text-sm text-dark w-1/4"},L={key:0},C={class:"flex items-center text-sm text-dark w-1/4"},_={key:0};function R(e,t,s,r,o,a){const n=(0,l.g2)("ReplyOverlay");return o.profile?((0,l.uX)(),(0,l.CE)("div",d,[(0,l.Lk)("div",u,[(0,l.Lk)("a",{onClick:t[0]||(t[0]=e=>a.gotoProfile(o.profile.id))},[(0,l.Lk)("img",{src:`${o.profile.avatar||"default_profile.png"}`,class:"h-12 w-12 rounded-full flex-none"},null,8,w)])]),(0,l.Lk)("div",h,[(0,l.Lk)("div",c,[(0,l.Lk)("a",{onClick:t[1]||(t[1]=e=>a.gotoProfile(s.tweet.user_id))},[(0,l.Lk)("p",f,(0,i.v_)(s.tweet.username),1)]),(0,l.Lk)("p",p," @"+(0,i.v_)(s.tweet.user_id),1),t[8]||(t[8]=(0,l.Lk)("p",{class:"text-sm text-dark ml-2"},"·",-1)),(0,l.Lk)("p",k,(0,i.v_)(e.$filters.timeago(s.tweet.created_at)),1),(0,l.Lk)("div",null,[(0,l.Lk)("i",{onClick:t[2]||(t[2]=e=>o.showDropdown=!o.showDropdown),class:"fas fa-angle-down text-sm ml-auto text-dark cursor-pointer"}),o.showDropdown?((0,l.uX)(),(0,l.CE)("div",g,[(0,l.Lk)("a",{onClick:t[3]||(t[3]=(...e)=>this.delete&&this.delete(...e)),class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},"Delete tweet")])):(0,l.Q3)("",!0)])]),(0,l.Lk)("a",null,[(0,l.Lk)("p",m,(0,i.v_)(s.tweet.text),1)]),(0,l.Lk)("div",x,[(0,l.Lk)("div",b,[(0,l.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>a.replyToTweet&&a.replyToTweet(...e)),class:"mr-2 rounded-full hover:bg-lighter"},t[9]||(t[9]=[(0,l.Lk)("i",{class:"far fa-comment"},null,-1)])),s.tweet.replies>0?((0,l.uX)(),(0,l.CE)("p",v,(0,i.v_)(s.tweet.replies),1)):(0,l.Q3)("",!0)]),(0,l.Lk)("div",y,[(0,l.Lk)("button",{onClick:t[5]||(t[5]=e=>a.retweet()),class:"mr-2 rounded-full hover:bg-lighter"},[(0,l.Lk)("i",{class:(0,i.C4)("fas fa-retweet "+(s.tweet.retweeted_by?"text-green-500":""))},null,2)]),a.getRetweetsCount(s.tweet.id)>0?((0,l.uX)(),(0,l.CE)("p",L,(0,i.v_)(a.getRetweetsCount(s.tweet.id)),1)):(0,l.Q3)("",!0)]),(0,l.Lk)("div",C,[(0,l.Lk)("button",{onClick:t[6]||(t[6]=e=>a.like()),class:"mr-2 rounded-full hover:bg-lighter"},[(0,l.Lk)("i",{class:(0,i.C4)("fas fa-heart "+(a.getLikesCount(s.tweet.id)>0?"text-red-600":""))},null,2)]),a.getLikesCount(s.tweet.id)>0?((0,l.uX)(),(0,l.CE)("p",_,(0,i.v_)(a.getLikesCount(s.tweet.id)),1)):(0,l.Q3)("",!0)]),t[10]||(t[10]=(0,l.Lk)("div",{class:"flex items-center text-sm text-dark w-1/4"},[(0,l.Lk)("i",{class:"fas fa-share-square mr-3"})],-1))])]),(0,l.bF)(n,{tweet:s.tweet,profile:o.profile,show:o.showReplyOverlay,"onUpdate:show":t[7]||(t[7]=e=>o.showReplyOverlay=e)},null,8,["tweet","profile","show"])])):(0,l.Q3)("",!0)}s(4114);var T=s(945),E=s(6278),Q={name:"Tweet",props:["tweet"],components:{ReplyOverlay:T.A},data(){return{profile:{},likersCursor:"",retweetersCursor:"",showReplyOverlay:!1,showDropdown:!1}},methods:{...(0,E.i0)("warpnet",["getProfile","likeTweet","unlikeTweet","deleteTweet","getTweet","getLikesNum","getLikers","retweetTweet","unretweetTweet","getRetweetsNum","getRetweeters","getTweetReply","deleteTweetReply"]),gotoProfile(e){this.$router.push({name:"Profile",params:{id:e}})},async get(){let e;if(this.tweet.parent_id&&""!==this.tweet.parent_id){const t={rootId:this.tweet.root_id,replyId:this.tweet.id};e=await this.getTweetReply(t)}else{const t={userId:this.tweet.user_id,tweetId:this.tweet.id};e=await this.getTweet(t)}console.log("tweet or reply",e),this.showReplyOverlay=!0},async delete(){if(this.tweet.parent_id&&""!==this.tweet.parent_id){const e={userId:this.profile.id,rootId:this.tweet.root_id,replyId:this.tweet.id};await this.deleteTweetReply(e)}else{const e={userId:this.tweet.user_id,tweetId:this.tweet.id};await this.deleteTweet(e),this.gotoProfile(this.profile.id)}},replyToTweet(){this.showReplyOverlay=!0},async retweet(){console.log("retweet",this.tweet);let e=0;if(this.retweeters.has(this.tweet.id)){if(this.retweeters.get(this.tweet.id).has(this.tweet.user_id)&&""!==this.tweet.retweeted_by)e=await this.unretweetTweet(this.tweet.id).catch((e=>{console.error(`failed to unretweet [${this.tweet.id}]`,e)})),this.retweeters.get(this.tweet.id).delete(this.tweet.user_id);else{const t={tweetId:this.tweet.id,userId:this.tweet.user_id,username:this.tweet.username,text:this.tweet.text};e=await this.retweetTweet(t).catch((e=>{console.error(`failed to retweet [${this.tweet.id}]`,e)})),this.retweeters.get(this.tweet.id).set(this.tweet.user_id,this.profile)}this.retweetsCount.set(this.tweet.id,e)}else console.error("failed to retweet tweet",this.tweet.id)},async like(){let e=0;this.likers.has(this.tweet.id)?(this.likers.get(this.tweet.id).has(this.tweet.user_id)?(e=await this.unlikeTweet(this.tweet.id).catch((e=>{console.error(`failed to unlike tweet [${this.tweet.id}]`,e)})),this.likers.get(this.tweet.id).delete(this.tweet.user_id)):(e=await this.likeTweet(this.tweet.id).catch((e=>{console.error(`failed to like tweet [${this.tweet.id}]`,e)})),this.likers.get(this.tweet.id).set(this.tweet.user_id,this.profile)),this.likesCount.set(this.tweet.id,e)):console.error("failed to like tweet",this.tweet.id)},getLikesCount(e){return this.likesCount.get(e)},getRetweetsCount(e){return this.retweetsCount.get(e)}},async created(){this.likesCount=new Map,this.retweetsCount=new Map,this.likers=new Map,this.retweeters=new Map,this.profile=await this.getProfile(this.$route.params.id),this.likesCount.set(this.tweet.id,await this.getLikesNum(this.tweet.id)),this.retweetsCount.set(this.tweet.id,await this.getRetweetsNum(this.tweet.id));let e=await this.getLikers(this.tweet.id,this.likersCursor);this.likers.set(this.tweet.id,new Map),this.likersCursor=e.cursor;for(let s=0;null!==e.users&&s<e.users.length;s++){let t=this.likers.get(this.tweet.id);t.set(e.users[s].id,e.users[s]),this.likers.set(this.tweet.id,t)}let t=await this.getRetweeters(this.tweet.id,this.retweetersCursor);this.retweeters.set(this.tweet.id,new Map),this.retweetersCursor=t.cursor;for(let s=0;null!==t.users&&s<t.users.length;s++){let e=this.retweeters.get(this.tweet.id);e.set(t.users[s].id,t.users[s]),this.retweeters.set(this.tweet.id,e)}}},$=s(6262);const O=(0,$.A)(Q,[["render",R]]);var M=O,I={name:"Retweet",props:["tweet"],components:{Tweet:M},methods:{...(0,E.i0)("warpnet",["getOwnerProfile"])},data(){return{profile:{},label:"None"}},async created(){try{this.profile=await this.getOwnerProfile(),this.tweet.retweeted_by===this.profile.id?this.label="You Retweeted":this.label=`${this.tweet.username} Retweeted`}catch(e){console.error("Failed to get profile:",e)}}};const P=(0,$.A)(I,[["render",n]]);var X=P},146:function(e,t,s){s.d(t,{A:function(){return P}});var l=s(641),i=s(33);const r={class:"w-1/6 md:w-1/12 xl:w-1/6 border-r border-lighter lg:px-6 py-2 flex-col justify-between hidden sm:flex"},o={key:0,class:"absolute -mt-6 ml-2"},a={class:"inline-flex items-center px-1.5 py-0.5 border-2 border-white rounded-full text-xs font-semibold leading-4 bg-blue text-white"},n={key:0,class:"absolute -mt-6 ml-2"},d={class:"inline-flex items-center px-1.5 py-0.5 border-2 border-white rounded-full text-xs font-semibold leading-4 bg-blue text-white"},u={key:0,class:"xl:w-full relative mt-2 w-10 h-10"},w=["src"],h={class:"hidden xl:block ml-4 truncate"},c={class:"text-left text-sm font-bold leading-tight truncate"},f={class:"text-left text-sm leading-tight text-dark truncate"},p={key:0,class:"absolute bottom-0 left-0 w-64 rounded-lg shadow-md border-lightest bg-white mb-16"},k=["src"],g={class:"ml-4"},m={class:"text-left text-sm font-bold leading-tight"},x={class:"text-left text-sm leading-tight text-dark"};function b(e,t,s,b,v,y){const L=(0,l.g2)("QRCodeModal");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("div",null,[(0,l.bF)(L,{show:e.qrModalOpen,qrData:e.qrCode,onClose:e.closeQRCodeModal},null,8,["show","qrData","onClose"])]),(0,l.Lk)("div",r,[(0,l.Lk)("div",null,[t[15]||(t[15]=(0,l.Lk)("button",{class:"h-12 w-12 hover:bg-lightblue text-3xl text-blue rounded-full"},null,-1)),(0,l.Lk)("div",null,[(0,l.Lk)("button",{onClick:t[0]||(t[0]=e=>y.open("Home")),class:"focus:outline-none hover:text-blue flex items-center px-4 py-2 hover:bg-transparent md:hover:bg-lightblue rounded-full mr-auto mb-1"},[(0,l.Lk)("i",{class:(0,i.C4)(["fa fa-home","Home"===e.$route.name?"text-2xl":"text-xl"]),"aria-hidden":"true"},null,2),(0,l.Lk)("p",{class:(0,i.C4)(["text-lg ml-4 text-left hidden xl:block","Home"===e.$route.name?"font-bold":""])}," Home ",2)]),t[12]||(t[12]=(0,l.Lk)("button",{class:"focus:outline-none hover:text-blue flex items-center px-4 py-2 hover:bg-transparent md:hover:bg-lightblue rounded-full mr-auto mb-1"},[(0,l.Lk)("i",{class:"fas fa-hashtag","aria-hidden":"true"}),(0,l.Lk)("p",{class:"text-lg ml-4 text-left hidden xl:block"},"Explore")],-1)),(0,l.Lk)("button",{onClick:t[1]||(t[1]=e=>y.open("Notifications")),class:"relative focus:outline-none hover:text-blue flex items-center px-4 py-2 hover:bg-transparent md:hover:bg-lightblue rounded-full mr-auto mb-1"},[(0,l.Lk)("i",{class:(0,i.C4)(["fa-bell","Notifications"===e.$route.name?"text-2xl fas":"text-xl far"]),"aria-hidden":"true"},null,2),v.newNotifications>0?((0,l.uX)(),(0,l.CE)("span",o,[(0,l.Lk)("div",a,(0,i.v_)(v.newNotifications),1)])):(0,l.Q3)("",!0),(0,l.Lk)("p",{class:(0,i.C4)(["text-lg ml-4 text-left hidden xl:block","Notifications"===e.$route.name?"font-bold":""])}," Notifications ",2)]),(0,l.Lk)("button",{onClick:t[2]||(t[2]=e=>y.open("Chats")),class:"focus:outline-none hover:text-blue flex items-center px-4 py-2 hover:bg-transparent md:hover:bg-lightblue rounded-full mr-auto mb-1"},[(0,l.Lk)("i",{class:(0,i.C4)(["fa-envelope","Chats"===e.$route.name?"text-2xl fas":"text-xl far"]),"aria-hidden":"true"},null,2),v.newMessages>0?((0,l.uX)(),(0,l.CE)("span",n,[(0,l.Lk)("div",d,(0,i.v_)(v.newMessages),1)])):(0,l.Q3)("",!0),(0,l.Lk)("p",{class:(0,i.C4)(["text-lg ml-4 text-left hidden xl:block","Chats"===e.$route.name?"font-bold":""])}," Messages ",2)]),t[13]||(t[13]=(0,l.Fv)('<button class="focus:outline-none hover:text-blue flex items-center px-4 py-2 hover:bg-transparent md:hover:bg-lightblue rounded-full mr-auto mb-1"><i class="text-xl far fa-bookmark" aria-hidden="true"></i><p class="text-lg ml-4 text-left hidden xl:block">Bookmarks</p></button><button class="focus:outline-none hover:text-blue flex items-center px-4 py-2 hover:bg-transparent md:hover:bg-lightblue rounded-full mr-auto mb-1"><i class="text-xl fas fa-clipboard-list" aria-hidden="true"></i><p class="text-lg ml-4 text-left hidden xl:block">Lists</p></button>',2)),(0,l.Lk)("button",{onClick:t[3]||(t[3]=e=>y.open("Profile")),class:"focus:outline-none hover:text-blue flex items-center px-4 py-2 hover:bg-transparent md:hover:bg-lightblue rounded-full mr-auto mb-1"},[(0,l.Lk)("i",{class:(0,i.C4)(["fa-user","Profile"===e.$route.name?"text-2xl fas":"text-xl far"]),"aria-hidden":"true"},null,2),(0,l.Lk)("p",{class:(0,i.C4)(["text-lg ml-4 text-left hidden xl:block","Profile"===e.$route.name?"font-bold":""])}," Profile ",2)]),(0,l.Lk)("button",{onClick:t[4]||(t[4]=()=>{}),class:"focus:outline-none hover:text-blue flex items-center px-4 py-2 hover:bg-transparent md:hover:bg-lightblue rounded-full mr-auto mb-1"},t[11]||(t[11]=[(0,l.Lk)("i",{class:"text-xl fas gear","aria-hidden":"true"},null,-1),(0,l.Lk)("p",{class:"text-lg ml-4 text-left hidden xl:block"},"Settings",-1)]))]),(0,l.Lk)("button",{onClick:t[5]||(t[5]=e=>y.open("Home")),class:"text-white bg-blue rounded-full font-semibold h-12 lg:h-auto w-12 xl:w-full hover:bg-darkblue p-3"},t[14]||(t[14]=[(0,l.Lk)("p",{class:"hidden xl:block"},"Tweet",-1),(0,l.Lk)("i",{class:"fas fa-plus xl:hidden"},null,-1)]))]),v.profile?((0,l.uX)(),(0,l.CE)("div",u,[(0,l.Lk)("button",{onClick:t[6]||(t[6]=e=>v.dropdown=!v.dropdown),class:"flex items-center w-full hover:bg-lightblue rounded-full"},[(0,l.Lk)("img",{src:v.profile.avatar||"default_profile.png",class:"w-10 h-10 rounded-full",alt:"Profile avatar"},null,8,w),(0,l.Lk)("div",h,[(0,l.Lk)("div",c,(0,i.v_)(v.profile.username),1),(0,l.Lk)("div",f,(0,i.v_)(v.profile.id),1)]),t[16]||(t[16]=(0,l.Lk)("i",{class:"hidden xl:block fas fa-angle-down ml-auto text-lg"},null,-1))]),v.dropdown?((0,l.uX)(),(0,l.CE)("div",p,[(0,l.Lk)("button",{onClick:t[7]||(t[7]=e=>v.dropdown=!1),class:"p-3 flex items-center w-full hover:bg-lightest"},[(0,l.Lk)("img",{src:v.profile.avatar||"default_profile.png",class:"w-10 h-10 rounded-full",alt:"Profile avatar"},null,8,k),(0,l.Lk)("div",g,[(0,l.Lk)("p",m,(0,i.v_)(v.profile.username),1),(0,l.Lk)("p",x,(0,i.v_)(v.profile.id),1)]),t[17]||(t[17]=(0,l.Lk)("i",{class:"fas fa-check ml-auto text-blue"},null,-1))]),(0,l.Lk)("button",{class:"w-full text-left hover:bg-lightest border-t border-lighter p-3 text-sm",onClick:t[8]||(t[8]=(...e)=>y.toggleDarkMode&&y.toggleDarkMode(...e))}," Toggle Theme "),t[18]||(t[18]=(0,l.Lk)("button",{class:"w-full text-left hover:bg-lightest border-t border-lighter p-3 text-sm"}," Add an existing account ",-1)),(0,l.Lk)("button",{onClick:t[9]||(t[9]=(...e)=>y.signInByQR&&y.signInByQR(...e)),class:"w-full text-left hover:bg-lightest border-t border-lighter p-3 text-sm"}," Sign in by QR-code "),(0,l.Lk)("button",{onClick:t[10]||(t[10]=(...e)=>y.signOut&&y.signOut(...e)),class:"w-full text-left hover:bg-lightest border-t border-lighter p-3 text-sm"}," Log out "+(0,i.v_)(v.profile.username),1)])):(0,l.Q3)("",!0)])):(0,l.Q3)("",!0)])],64)}s(4114);var v=s(3751);const y={class:"bg-white rounded-lg shadow-lg p-6 w-80 relative"},L={key:0,class:"flex justify-center mb-4"},C=["src"],_={key:1,class:"text-center text-gray-500"};function R(e,t,s,i,r,o){return s.show?((0,l.uX)(),(0,l.CE)("div",{key:0,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",onClick:t[1]||(t[1]=(0,v.D$)(((...e)=>o.close&&o.close(...e)),["self"]))},[(0,l.Lk)("div",y,[(0,l.Lk)("button",{class:"absolute top-2 right-2 text-gray-500 hover:text-gray-700",onClick:t[0]||(t[0]=(...e)=>o.close&&o.close(...e))},t[2]||(t[2]=[(0,l.Lk)("i",{class:"fas fa-times"},null,-1)])),t[4]||(t[4]=(0,l.Lk)("h3",{class:"text-xl font-semibold text-center mb-4"},"Your QR Code",-1)),s.qrData?((0,l.uX)(),(0,l.CE)("div",L,[(0,l.Lk)("img",{src:s.qrData,alt:"QR Code",class:"w-48 h-48"},null,8,C)])):((0,l.uX)(),(0,l.CE)("div",_,t[3]||(t[3]=[(0,l.Lk)("p",null,"No QR code is currently available. Please try again later.",-1)]))),t[5]||(t[5]=(0,l.Lk)("p",{class:"text-sm text-gray-600 text-center"}," Scan this QR code with your app to log in. ",-1))])])):(0,l.Q3)("",!0)}var T=s(6278),E={props:{show:{type:Boolean,required:!0},qrData:{type:String,required:!1}},methods:{...(0,T.i0)("authentication",["closeQRCodeModal"]),close(){this.closeQRCodeModal()},handleEscape(e){"Escape"===e.key&&this.close()}},mounted(){window.addEventListener("keydown",this.handleEscape)},beforeDestroy(){window.removeEventListener("keydown",this.handleEscape)}},Q=s(6262);const $=(0,Q.A)(E,[["render",R]]);var O=$,M={name:"SideNav",data(){return{dropdown:!1,profile:{},newMessages:0,newNotifications:0}},async created(){this.profile=await this.getOwnerProfile()},mounted(){const e=localStorage.getItem("theme");"dark"===e||!e&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},components:{QRCodeModal:O},computed:{...(0,T.L8)("authentication",["qrCode","qrModalOpen"])},methods:{...(0,T.i0)("authentication",["logoutUser","closeQRCodeModal","openQRCodeModal"]),...(0,T.i0)("warpnet",["getOwnerProfile"]),async open(e){const t=this.$route.name;e===t&&this.$route.params.id===this.profile.id||this.$router.push({name:e,params:{id:this.profile.id}})},toggleDarkMode(){const e=document.documentElement;e.classList.contains("dark")?(e.classList.remove("dark"),localStorage.setItem("theme","light")):(e.classList.add("dark"),localStorage.setItem("theme","dark"))},async signInByQR(){try{console.log("signing in by QR..."),await this.openQRCodeModal(),console.log("QR code modal:",this.qrModalOpen)}catch(e){alert("Error signing in by QR, please check console to read the error details"),console.log("Error signing in by QR:",e)}},async signOut(){try{await this.logoutUser()}catch(e){alert("Error signing out, please check console for error details"),console.log("Error signing out:",e)}}}};const I=(0,Q.A)(M,[["render",b]]);var P=I},652:function(e,t,s){s.d(t,{A:function(){return E}});var l=s(641),i=s(33);const r={key:0,class:"w-full p-2 pt-1 pb-1 md:p-4 md:pt-2 md:pb-2 border-b hover:bg-lightest flex"},o={class:"flex-none mr-2 md:mr-4 pt-1"},a=["src"],n={class:"w-full"},d={class:"flex items-center w-full"},u={class:"font-semibold"},w={class:"hidden md:block text-sm text-dark ml-2"},h={class:"text-sm text-dark ml-2"},c={key:0,class:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1"},f={class:"pb-2"},p={class:"flex w-full"},k={class:"flex items-center text-sm text-dark w-1/4"},g={key:0},m={class:"flex items-center text-sm text-dark w-1/4"},x={key:0},b={class:"flex items-center text-sm text-dark w-1/4"},v={key:0};function y(e,t,s,y,L,C){const _=(0,l.g2)("ReplyOverlay");return L.profile?((0,l.uX)(),(0,l.CE)("div",r,[(0,l.Lk)("div",o,[(0,l.Lk)("a",{onClick:t[0]||(t[0]=e=>C.gotoProfile(L.profile.id))},[(0,l.Lk)("img",{src:`${L.profile.avatar||"default_profile.png"}`,class:"h-12 w-12 rounded-full flex-none"},null,8,a)])]),(0,l.Lk)("div",n,[(0,l.Lk)("div",d,[(0,l.Lk)("a",{onClick:t[1]||(t[1]=e=>C.gotoProfile(s.tweet.user_id))},[(0,l.Lk)("p",u,(0,i.v_)(s.tweet.username),1)]),(0,l.Lk)("p",w," @"+(0,i.v_)(s.tweet.user_id),1),t[8]||(t[8]=(0,l.Lk)("p",{class:"text-sm text-dark ml-2"},"·",-1)),(0,l.Lk)("p",h,(0,i.v_)(e.$filters.timeago(s.tweet.created_at)),1),(0,l.Lk)("div",null,[(0,l.Lk)("i",{onClick:t[2]||(t[2]=e=>L.showDropdown=!L.showDropdown),class:"fas fa-angle-down text-sm ml-auto text-dark cursor-pointer"}),L.showDropdown?((0,l.uX)(),(0,l.CE)("div",c,[(0,l.Lk)("a",{onClick:t[3]||(t[3]=(...e)=>this.delete&&this.delete(...e)),class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},"Delete tweet")])):(0,l.Q3)("",!0)])]),(0,l.Lk)("a",null,[(0,l.Lk)("p",f,(0,i.v_)(s.tweet.text),1)]),(0,l.Lk)("div",p,[(0,l.Lk)("div",k,[(0,l.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>C.replyToTweet&&C.replyToTweet(...e)),class:"mr-2 rounded-full hover:bg-lighter"},t[9]||(t[9]=[(0,l.Lk)("i",{class:"far fa-comment"},null,-1)])),s.tweet.replies>0?((0,l.uX)(),(0,l.CE)("p",g,(0,i.v_)(s.tweet.replies),1)):(0,l.Q3)("",!0)]),(0,l.Lk)("div",m,[(0,l.Lk)("button",{onClick:t[5]||(t[5]=e=>C.retweet()),class:"mr-2 rounded-full hover:bg-lighter"},[(0,l.Lk)("i",{class:(0,i.C4)("fas fa-retweet "+(s.tweet.retweeted_by?"text-green-500":""))},null,2)]),C.getRetweetsCount(s.tweet.id)>0?((0,l.uX)(),(0,l.CE)("p",x,(0,i.v_)(C.getRetweetsCount(s.tweet.id)),1)):(0,l.Q3)("",!0)]),(0,l.Lk)("div",b,[(0,l.Lk)("button",{onClick:t[6]||(t[6]=e=>C.like()),class:"mr-2 rounded-full hover:bg-lighter"},[(0,l.Lk)("i",{class:(0,i.C4)("fas fa-heart "+(C.getLikesCount(s.tweet.id)>0?"text-red-600":""))},null,2)]),C.getLikesCount(s.tweet.id)>0?((0,l.uX)(),(0,l.CE)("p",v,(0,i.v_)(C.getLikesCount(s.tweet.id)),1)):(0,l.Q3)("",!0)]),t[10]||(t[10]=(0,l.Lk)("div",{class:"flex items-center text-sm text-dark w-1/4"},[(0,l.Lk)("i",{class:"fas fa-share-square mr-3"})],-1))])]),(0,l.bF)(_,{tweet:s.tweet,profile:L.profile,show:L.showReplyOverlay,"onUpdate:show":t[7]||(t[7]=e=>L.showReplyOverlay=e)},null,8,["tweet","profile","show"])])):(0,l.Q3)("",!0)}s(4114);var L=s(945),C=s(6278),_={name:"Tweet",props:["tweet"],components:{ReplyOverlay:L.A},data(){return{profile:{},likersCursor:"",retweetersCursor:"",showReplyOverlay:!1,showDropdown:!1}},methods:{...(0,C.i0)("warpnet",["getProfile","likeTweet","unlikeTweet","deleteTweet","getTweet","getLikesNum","getLikers","retweetTweet","unretweetTweet","getRetweetsNum","getRetweeters","getTweetReply","deleteTweetReply"]),gotoProfile(e){this.$router.push({name:"Profile",params:{id:e}})},async get(){let e;if(this.tweet.parent_id&&""!==this.tweet.parent_id){const t={rootId:this.tweet.root_id,replyId:this.tweet.id};e=await this.getTweetReply(t)}else{const t={userId:this.tweet.user_id,tweetId:this.tweet.id};e=await this.getTweet(t)}console.log("tweet or reply",e),this.showReplyOverlay=!0},async delete(){if(this.tweet.parent_id&&""!==this.tweet.parent_id){const e={userId:this.profile.id,rootId:this.tweet.root_id,replyId:this.tweet.id};await this.deleteTweetReply(e)}else{const e={userId:this.tweet.user_id,tweetId:this.tweet.id};await this.deleteTweet(e),this.gotoProfile(this.profile.id)}},replyToTweet(){this.showReplyOverlay=!0},async retweet(){console.log("retweet",this.tweet);let e=0;if(this.retweeters.has(this.tweet.id)){if(this.retweeters.get(this.tweet.id).has(this.tweet.user_id)&&""!==this.tweet.retweeted_by)e=await this.unretweetTweet(this.tweet.id).catch((e=>{console.error(`failed to unretweet [${this.tweet.id}]`,e)})),this.retweeters.get(this.tweet.id).delete(this.tweet.user_id);else{const t={tweetId:this.tweet.id,userId:this.tweet.user_id,username:this.tweet.username,text:this.tweet.text};e=await this.retweetTweet(t).catch((e=>{console.error(`failed to retweet [${this.tweet.id}]`,e)})),this.retweeters.get(this.tweet.id).set(this.tweet.user_id,this.profile)}this.retweetsCount.set(this.tweet.id,e)}else console.error("failed to retweet tweet",this.tweet.id)},async like(){let e=0;this.likers.has(this.tweet.id)?(this.likers.get(this.tweet.id).has(this.tweet.user_id)?(e=await this.unlikeTweet(this.tweet.id).catch((e=>{console.error(`failed to unlike tweet [${this.tweet.id}]`,e)})),this.likers.get(this.tweet.id).delete(this.tweet.user_id)):(e=await this.likeTweet(this.tweet.id).catch((e=>{console.error(`failed to like tweet [${this.tweet.id}]`,e)})),this.likers.get(this.tweet.id).set(this.tweet.user_id,this.profile)),this.likesCount.set(this.tweet.id,e)):console.error("failed to like tweet",this.tweet.id)},getLikesCount(e){return this.likesCount.get(e)},getRetweetsCount(e){return this.retweetsCount.get(e)}},async created(){this.likesCount=new Map,this.retweetsCount=new Map,this.likers=new Map,this.retweeters=new Map,this.profile=await this.getProfile(this.$route.params.id),this.likesCount.set(this.tweet.id,await this.getLikesNum(this.tweet.id)),this.retweetsCount.set(this.tweet.id,await this.getRetweetsNum(this.tweet.id));let e=await this.getLikers(this.tweet.id,this.likersCursor);this.likers.set(this.tweet.id,new Map),this.likersCursor=e.cursor;for(let s=0;null!==e.users&&s<e.users.length;s++){let t=this.likers.get(this.tweet.id);t.set(e.users[s].id,e.users[s]),this.likers.set(this.tweet.id,t)}let t=await this.getRetweeters(this.tweet.id,this.retweetersCursor);this.retweeters.set(this.tweet.id,new Map),this.retweetersCursor=t.cursor;for(let s=0;null!==t.users&&s<t.users.length;s++){let e=this.retweeters.get(this.tweet.id);e.set(t.users[s].id,t.users[s]),this.retweeters.set(this.tweet.id,e)}}},R=s(6262);const T=(0,R.A)(_,[["render",y]]);var E=T}}]);
//# sourceMappingURL=92.1ef31461.js.map