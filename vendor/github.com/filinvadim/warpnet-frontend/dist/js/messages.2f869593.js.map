{"version":3,"file":"js/messages.2f869593.js","mappings":"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","sources":["webpack://warpnet-frontend/./src/views/Conversation.vue","webpack://warpnet-frontend/./src/views/Conversation.vue?e9cd","webpack://warpnet-frontend/./src/views/Conversations.vue","webpack://warpnet-frontend/./src/views/Conversations.vue?b98d","webpack://warpnet-frontend/./src/views/Messages.vue","webpack://warpnet-frontend/./src/views/Messages.vue?2e03","webpack://warpnet-frontend/./node_modules/core-js/modules/es.iterator.find.js"],"sourcesContent":["<template>\n  <div class=\"flex container h-full w-full\">\n    <SideNav />\n    \n    <div class=\"flex-1 flex flex-col h-full\">\n      <!-- Header -->\n      <div class=\"px-4 py-3 border-b border-lighter flex items-center\">\n        <router-link :to=\"{ name: 'Chats' }\" class=\"mr-4\">\n          <i class=\"fas fa-arrow-left text-xl text-blue\"></i>\n        </router-link>\n        \n        <div v-if=\"chat\" class=\"flex items-center\">\n          <img :src=\"otherUser.avatar || 'default_profile.png'\"\n               class=\"w-10 h-10 rounded-full mr-3\" />\n          <div>\n            <p class=\"font-bold\">{{ otherUser.username }}</p>\n            <p class=\"text-sm text-dark\">@{{ chat.other_user_id }}</p>\n          </div>\n        </div>\n      </div>\n\n      <!-- Messages -->\n      <div class=\"flex-1 overflow-y-auto p-4\" ref=\"messageContainer\">\n        <div v-if=\"loading\" class=\"flex justify-center\">\n          <Loader :loading=\"loading\" />\n        </div>\n\n        <template v-else>\n          <div v-for=\"message in messages\" :key=\"message.id\" \n               class=\"mb-4 flex\"\n               :class=\"{'justify-end': message.sender_id === currentUserId}\">\n            <div class=\"max-w-3/4 rounded-lg px-4 py-2\"\n                 :class=\"message.sender_id === currentUserId ?\n                        'bg-blue text-white' : 'bg-lighter'\">\n              <p v-linkify>{{ message.text }}</p>\n              <p class=\"text-xs mt-1 text-gray-500\">\n                {{ $filters.timeago(message.created_at) }}\n              </p>\n            </div>\n          </div>\n        </template>\n      </div>\n\n      <!-- Message Input -->\n      <div class=\"border-t border-lighter px-4 py-3\">\n        <form @submit.prevent=\"sendMessage\" class=\"flex\">\n          <input v-model=\"newMessage\" \n                 type=\"text\"\n                 placeholder=\"Type a message...\"\n                 class=\"flex-1 rounded-full border border-lighter px-4 py-2 mr-2\" />\n          <button type=\"submit\" \n                  class=\"bg-blue text-white rounded-full px-6 py-2\">\n            Send\n          </button>\n        </form>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport {defineAsyncComponent} from \"vue\";\nimport {warpnetService} from \"@/service/service\";\n\nexport default {\n  name: 'Chat',\n  components: {\n    SideNav: defineAsyncComponent(() => import('../components/SideNav.vue')),\n    Loader: defineAsyncComponent(() => import('../components/Loader.vue')),\n  },\n  data() {\n    return {\n      loading: true,\n      chat: null,\n      messages: [],\n      newMessage: '',\n      chatId: undefined,\n      currentUserId: undefined,\n      otherUser: undefined,\n    };\n  },\n  methods: {\n    async loadChat() {\n      try {\n        this.chat = await warpnetService.getChat({\n          chatId: this.chatId\n        });\n      } catch (error) {\n        console.error('Error loading chat:', error);\n      }\n    },\n\n    async loadMessages() {\n      try {\n        const messages = await warpnetService.getDirectMessages(\n            {chatId:this.chatId, cursorReset:true},\n        );\n\n        this.messages = [...messages, ...this.messages];\n      } catch (error) {\n        console.error('Error loading messages:', error);\n      }\n    },\n\n    async sendMessage() {\n      if (!this.newMessage.trim()) return;\n\n      try {\n        const message = await warpnetService.sendDirectMessage( {\n          chatId: this.chatId,\n          receiverId: this.otherUser.id,\n          text: this.newMessage,\n        });\n        this.messages.push(message);\n        this.newMessage = '';\n        this.scrollToBottom();\n      } catch (error) {\n        console.error('Error sending message:', error);\n      }\n    },\n\n    scrollToBottom() {\n      this.$nextTick(() => {\n        const container = this.$refs.messageContainer;\n        container.scrollTop = container.scrollHeight;\n      });\n    }\n  },\n  async created() {\n    console.log(\"loading component:\", this.$options.name);\n    this.currentUserId = this.$route.params.id;\n    this.chatId = this.$route.params.chatId;\n\n    await Promise.all([\n      this.loadChat(),\n      this.loadMessages()\n    ]);\n\n    if (this.chat.owner_id !== this.currentUserId) {\n      this.otherUser = await warpnetService.getProfile(this.chat.owner_id)\n    } else {\n      this.otherUser = await warpnetService.getProfile(this.chat.other_user_id)\n    }\n    this.otherUser.avatar = await warpnetService.getImage({userId:this.otherUser.id, key:this.otherUser.avatar_key})\n    this.loading = false;\n    this.scrollToBottom();\n  }\n};\n</script>","import { render } from \"./Conversation.vue?vue&type=template&id=1ab3a1df\"\nimport script from \"./Conversation.vue?vue&type=script&lang=js\"\nexport * from \"./Conversation.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n  <div id=\"app\" class=\"flex container h-full w-full\" v-scroll:bottom=\"loadMore\">\n    <div class=\"flex container h-full w-full\">\n      <SideNav />\n\n      <div class=\"w-full sm:w-1/3 md:w-1/2 lg:w-1/2 h-full overflow-y-scroll no-scrollbar hidden md:block\">\n        <div class=\"px-5 py-3 border-b border-lighter flex\">\n          <h1 class=\"text-xl font-bold flex-1\">Chats</h1>\n          <i class=\"fas fa-cog text-xl text-blue cursor-pointer\"></i>\n          <i @click=\"newMessage()\" class=\"fas fa-plus-circle ml-3 text-xl text-blue cursor-pointer\"></i>\n        </div>\n\n        <!-- chats -->\n        <Loader :loading=\"loading\" />\n        <div v-if=\"!loading\">\n          <div v-if=\"chats.length === 0\" class=\"flex flex-col items-center justify-center w-full pt-10\">\n            <div class=\"w-1/2 flex flex-col items-center justify-center\">\n              <p class=\"font-bold text-lg\">No chats yet</p>\n              <p class=\"text-sm text-dark\">\n                Wait until someone starts a chat here.\n              </p>\n            </div>\n          </div>\n          <div v-for=\"chat in chats\" :key=\"chat.id\">\n            <div v-if=\"(getUser(chat.other_user_id))\">\n              <div class=\"cursor-pointer\">\n                <div class=\"w-full p-2 pt-1 pb-1 md:p-4 md:pt-2 md:pb-2 border-b hover:bg-lightest flex\"\n                  @click=\"selectChat(chat)\">\n                  <div class=\"flex-none mr-2 md:mr-4 pt-1\">\n                    <a :href=\"`#/${chat.other_user_id}`\">\n                      <img :src=\"getUser(chat.other_user_id).avatar || 'default_profile.png'\"\n                           class=\"flex-none w-12 h-12 rounded-full\"  />\n                    </a>\n                  </div>\n                  <div class=\"w-full truncate\">\n                    <div class=\"flex items-center w-full\">\n                      <p class=\"font-semibold\">{{ getUser(chat.other_user_id).username || 'Anonymous' }}</p>\n                      <p class=\"hidden md:block text-sm text-dark ml-2 truncate\">\n                        @{{ chat.other_user_id }}\n                      </p>\n                      <p class=\"text-sm text-dark ml-auto\">\n                        {{ $filters.timeago(chat.lastModified) }}\n                      </p>\n                    </div>\n                    <p class=\"pb-2 truncate\" v-linkify>{{ chat.last_message || \"\" }}</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"w-full border-l border-r border-lighter h-screen flex items-center justify-center\">\n        <div class=\"text-center\">\n          <h2 class=\"text-2xl font-bold mb-4\">Select a chat</h2>\n          <p class=\"text-gray-600\">Choose a chat from the list to start chatting</p>\n        </div>\n      </div>\n\n      <NewMessageOverlay\n        v-if=\"showNewMessageModal\"\n        v-model:showNewMessageModal=\"showNewMessageModal\"\n        :profileId=\"profileId\"\n        @selected=\"selected\"\n      />\n    </div>\n  </div>\n</template>\n\n<script>\nimport {defineAsyncComponent} from \"vue\";\nimport {warpnetService} from \"@/service/service\";\n\nexport default {\n  name: \"Chats\",\n  components: {\n    NewMessageOverlay: defineAsyncComponent(() => import('../components/NewMessageOverlay.vue')),\n    Loader: defineAsyncComponent(() => import('../components/Loader.vue')),\n    SideNav: defineAsyncComponent(() => import('../components/SideNav.vue')),\n  },\n  data() {\n    return {\n      loading: true,\n      showNewMessageModal: false,\n      chats: [],\n      profileId: \"\",\n      usersMap: new Map(),\n      otherUser: undefined,\n    };\n  },\n  methods: {\n    newMessage() {\n      this.showNewMessageModal = true;\n    },\n    async selectChat(chat) {\n      if (!chat || chat.id.length === 0) {\n        return\n      }\n      console.log('selectChat()')\n      this.$router.push({\n        name: 'Messages',\n        params: {\n          id: this.$route.params.id,\n          chatId: chat.id,\n        },\n      });\n    },\n    async selected(user) {\n      console.log('selected()')\n      if (!user || user.id.length === 0) {\n        return;\n      }\n      this.showNewMessageModal = false;\n\n      // Check if chat already exists\n      const existingChat = this.chats.find(\n        conv => conv.other_user_id === user.id\n      );\n\n      if (existingChat) {\n        await this.selectChat(existingChat);\n        return;\n      }\n      // Create new chat\n      const newChat = await warpnetService.createChat(user.id);\n      await this.selectChat(newChat);\n    },\n    getUser(userId) {\n      return this.usersMap.get(userId);\n    },\n    async loadChatUser(userId) {\n      if (!userId || userId.length === 0) {\n        return\n      }\n\n      const u = await warpnetService.getProfile(userId)\n      u.avatar = await warpnetService.getImage({userId:u.id, key:u.avatar_key})\n      this.usersMap.set(u.id, u)\n      console.log('usersMap', this.usersMap)\n    },\n    async loadMore() {\n      const chats = await warpnetService.getChats(false);\n      for (const chat of chats) {\n        await this.loadChatUser(chat.other_user_id)\n        await this.loadChatUser(chat.owner_id)\n      }\n      this.chats = [...this.chats, ...chats];\n    },\n  },\n\n  async created() {\n      console.log(\"loading component:\", this.$options.name);\n      this.profileId = this.$route.params.id\n      await this.loadChatUser(this.profileId)\n\n      const chats = await warpnetService.getChats(true);\n\n      for (const chat of chats) {\n        await this.loadChatUser(chat.owner_id)\n        await this.loadChatUser(chat.other_user_id)\n\n        if (chat.owner_id !== this.profileId) {\n          [chat.owner_id, chat.other_user_id] = [chat.other_user_id, chat.owner_id];\n        }\n      }\n      this.chats = chats;\n      this.loading = false;\n    }\n};\n</script>\n","import { render } from \"./Conversations.vue?vue&type=template&id=16d87947\"\nimport script from \"./Conversations.vue?vue&type=script&lang=js\"\nexport * from \"./Conversations.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n  <div id=\"app\" class=\"flex h-full w-full\">\n    <!-- Sidebar -->\n    <SideNav />\n\n    <!-- Chats list (center column) -->\n    <div class=\"hidden md:flex flex-col w-1/3 h-full overflow-y-scroll border-r border-lighter\">\n      <div class=\"px-5 py-3 border-b border-lighter flex items-center\">\n        <h1 class=\"text-xl font-bold flex-1\">Chats</h1>\n        <i class=\"fas fa-cog text-xl text-blue cursor-pointer\"></i>\n        <i @click=\"newMessage()\" class=\"fas fa-plus-circle ml-3 text-xl text-blue cursor-pointer\"></i>\n      </div>\n\n      <Loader :loading=\"loading\" />\n\n      <template v-if=\"!loading\">\n        <div v-if=\"chats.length === 0\" class=\"flex flex-col items-center justify-center pt-10\">\n          <p class=\"font-bold text-lg\">No chats yet</p>\n          <p class=\"text-sm text-dark\">Wait until someone starts a chat here.</p>\n        </div>\n\n        <div v-for=\"chat in chats\" :key=\"chat.id\"\n             class=\"cursor-pointer\"\n             :class=\"chat.id === active?.id ? 'border-r-2 border-blue' : ''\"\n             @click=\"selectChat(chat)\">\n          <div class=\"flex items-start px-4 py-2 hover:bg-lightest border-b\">\n            <div class=\"mr-4\">\n              <img\n                  :src=\"getUser(chat.other_user_id)?.avatar || 'default_profile.png'\"\n                  class=\"h-12 w-12 rounded-full\"\n              />\n            </div>\n            <div class=\"w-full truncate\">\n              <div class=\"flex items-center\">\n                <p class=\"font-semibold truncate\">{{ getUser(chat.other_user_id)?.username || 'Anonymous' }}</p>\n                <p class=\"text-sm text-dark ml-2 truncate hidden md:block\">\n                  @{{ chat.other_user_id }}\n                </p>\n                <p class=\"text-sm text-dark ml-auto\">\n                  {{ $filters.timeago(chat.updated_at) }}\n                </p>\n              </div>\n              <p class=\"text-sm truncate\" v-linkify>{{ chat.last_message || '' }}</p>\n            </div>\n          </div>\n        </div>\n      </template>\n    </div>\n\n    <!-- Placeholder (right column, if no active chat selected) -->\n    <div v-if=\"loading || !active\" class=\"flex flex-col w-full md:w-2/3 h-full items-center justify-center\">\n      <div class=\"w-3/5 text-center\">\n        <p class=\"font-bold text-lg\">You don’t have a message selected</p>\n        <p class=\"text-sm text-dark mt-2\">\n          This is where you’ll see messages from people you don’t follow.\n        </p>\n        <button\n            @click=\"newMessage()\"\n            class=\"mt-5 h-10 px-4 text-white font-semibold bg-blue hover:bg-darkblue rounded-full\"\n        >\n          New Message\n        </button>\n      </div>\n    </div>\n\n    <!-- Messages view -->\n    <div v-if=\"!loading && active\" class=\"flex flex-col w-full md:w-2/3 h-full\">\n      <!-- Top bar -->\n      <div class=\"flex items-center px-5 py-2 border-b border-lighter bg-white sticky top-0\">\n        <button @click=\"gotoHome()\" class=\"block md:hidden mr-2 focus:outline-none\">\n          <i class=\"fas fa-arrow-left text-blue\"></i>\n        </button>\n        <div class=\"mr-4\">\n          <img\n              :src=\"getUser(active.other_user_id)?.avatar || 'default_profile.png'\"\n              class=\"w-6 h-6 rounded-full\"\n          />\n        </div>\n        <div class=\"flex flex-col\">\n          <h1 class=\"font-bold\">{{ getUser(active.other_user_id)?.username }}</h1>\n          <p class=\"text-xs text-dark\">@{{ active.other_user_id }}</p>\n        </div>\n        <i class=\"fas fa-info-circle ml-auto text-xl text-blue cursor-pointer\"></i>\n      </div>\n\n      <!-- Messages -->\n      <div class=\"flex-1 overflow-y-scroll px-5 pt-5 no-scrollbar\" v-scroll:top=\"loadMore\">\n        <div class=\"flex flex-col-reverse\">\n          <div ref=\"scrollToMe\"></div>\n          <div v-for=\"message in messages\" :key=\"message.id\">\n            <!-- Own message -->\n            <div v-if=\"message.sender_id === ownerProfile.id\" class=\"flex justify-end mb-4\">\n              <div class=\"bg-blue text-white py-2 px-4 rounded-tl-3xl rounded-bl-3xl rounded-tr-xl\">\n                {{ message.text }}\n              </div>\n              <p class=\"text-xs text-dark ml-2\">{{ $filters.time(message.created_at) }}</p>\n            </div>\n            <!-- Incoming message -->\n            <div v-else class=\"flex items-start mb-4\">\n              <img\n                  :src=\"getUser(active.other_user_id)?.avatar || 'default_profile.png'\"\n                  class=\"h-8 w-8 rounded-full mr-2\"\n              />\n              <div class=\"bg-lighter text-black py-2 px-4 rounded-tr-3xl rounded-tl-xl rounded-br-3xl\">\n                {{ message.text }}\n              </div>\n              <p class=\"text-xs text-dark ml-2\">{{ $filters.time(message.created_at) }}</p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Input -->\n      <div class=\"px-5 py-3 border-t border-lighter flex items-center bg-white\">\n        <input\n            v-model=\"text\"\n            type=\"search\"\n            class=\"flex-1 px-4 py-2 rounded-full bg-lighter focus:bg-white focus:outline-none focus:ring-2 focus:ring-blue text-sm\"\n            placeholder=\"Start a new message\"\n            @keyup.enter=\"sendMessage\"\n            :disabled=\"disabled\"\n        />\n        <button\n            @click=\"sendMessage\"\n            :disabled=\"disabled || !text.length\"\n            class=\"ml-4 w-8 h-8 rounded-full focus:outline-none\"\n            :class=\"text.length === 0 ? 'opacity-50 cursor-default' : 'hover:bg-lightblue'\"\n        >\n          <i class=\"fas fa-arrow-right text-blue text-xl\"></i>\n        </button>\n      </div>\n    </div>\n\n    <!-- New message overlay -->\n    <NewMessageOverlay\n        :profileId=\"active?.other_user_id\"\n        v-if=\"showNewMessageModal\"\n        v-model:showNewMessageModal=\"showNewMessageModal\"\n        @selected=\"selected\"\n    />\n  </div>\n</template>\n\n\n<script>\nimport {defineAsyncComponent} from \"vue\";\nimport {warpnetService} from \"@/service/service\";\n\nexport default {\n  name: \"Messages\",\n  components: {\n    SideNav: defineAsyncComponent(() => import('@/components/SideNav.vue')),\n    Loader: defineAsyncComponent(() => import('@/components/Loader.vue')),\n    NewMessageOverlay: defineAsyncComponent(() => import('@/components/NewMessageOverlay.vue')),\n  },\n  data() {\n    return {\n      loading: true,\n      disabled: false,\n      showNewMessageModal: false,\n      chats: [],\n      messages: [],\n      ownerProfile: undefined,\n      active: undefined,\n      text: '',\n      usersMap: new Map(),\n      otherUser: undefined,\n    };\n  },\n  methods: {\n    newMessage() {\n      this.showNewMessageModal = true;\n    },\n    gotoHome() {\n      this.$router.push({\n        name: \"Home\",\n      });\n    },\n    async sendMessage() {\n      if (!this.active.other_user_id || this.text.length === 0) return;\n      this.disabled = true; // disable message input temporarily\n\n      const message = await warpnetService.sendDirectMessage({\n        chatId: this.active.id,\n        receiverId: this.active.other_user_id,\n        text: this.text,\n      })\n      this.messages = [message, ...this.messages]\n      this.text = \"\";\n      this.disabled = false;\n      await this.$nextTick(() => {\n        this.scrollToEnd();\n      });\n    },\n    scrollToEnd() {\n      this.$nextTick(() => {\n        const el = this.$refs.scrollToMe;\n        if (el) {\n          el.scrollIntoView({ behavior: \"smooth\" });\n        }\n        if (!this.$refs.input) {\n          return\n        }\n        setTimeout(() => this.$refs.input.focus(), 500);\n      });\n    },\n    async selected(user) {\n      if (!this.ownerProfile.id || !user.id) {\n        console.log(\"messages: no selected(user)\", this.ownerProfile, user)\n        return;\n      }\n      this.showNewMessageModal = false;\n\n      let currentChat = null\n      for (const chat of this.chats) {\n        const participants = [chat.owner_id, chat.other_user_id];\n        if (participants.includes(this.ownerProfile.id) && participants.includes(user.id)) {\n          currentChat = chat;\n          break;\n        }\n      }\n\n      if (!currentChat) {\n        currentChat = {\n          id: \"\",\n          other_user_id: user.id,\n          owner_id: this.ownerProfile.id,\n        };\n      }\n      await this.selectChat(currentChat);\n    },\n    async selectChat(chat) {\n      if (!chat) {\n        console.warn(\"no active chat selected\")\n        return\n      }\n      this.messages = []; // reset messages\n      this.active = chat;\n\n      this.messages = await warpnetService.getDirectMessages(\n          {chatId: chat.id, cursorReset: true},\n      );\n      this.scrollToEnd();\n    },\n    deselectAll() {\n      this.active = undefined;\n    },\n    getUser(userId) {\n      return this.usersMap.get(userId);\n    },\n    async loadChatUser(userId) {\n      const u = await warpnetService.getProfile(userId)\n      u.avatar = await warpnetService.getImage({userId:u.id, key:u.avatar_key})\n      this.usersMap.set(u.id, u)\n    },\n    async loadMore() {\n      if (!this.active) return;\n      const messagesResp = await warpnetService.getDirectMessages(\n          {chatId:this.active.chat.id, cursorReset:false},\n      )\n      this.messages = [...this.messages, ...messagesResp.messages];\n    },\n  },\n  async created() {\n    console.log(\"loading component:\", this.$options.name);\n    console.log(\"messages: route chat id:\", this.$route.params.chatId)\n\n    this.ownerProfile = warpnetService.getOwnerProfile()\n    await this.loadChatUser(this.ownerProfile.id)\n\n    const chats = await warpnetService.getChats(true)\n    if (chats.length === 0) {\n      console.warn(\"messages: chats not found\")\n      this.loading = false;\n      return;\n    }\n\n    let activeChat = null\n    for (const chat of chats) {\n      await this.loadChatUser(chat.owner_id)\n      await this.loadChatUser(chat.other_user_id)\n\n      if (chat.id === this.$route.params.chatId) {\n        console.log('ACTIVE CHAT', JSON.stringify(chat))\n        console.log('ACTIVE CHAT owner', chat.owner_id, \"other\", chat.other_user_id)\n        activeChat = chat\n      }\n      if (chat.owner_id !== this.ownerProfile.id) {\n        [chat.owner_id, chat.other_user_id] = [chat.other_user_id, chat.owner_id];\n      }\n    }\n\n    this.chats = chats;\n    await this.selectChat(activeChat);\n    this.loading = false;\n  },\n};\n</script>\n","import { render } from \"./Messages.vue?vue&type=template&id=bcb89b14\"\nimport script from \"./Messages.vue?vue&type=script&lang=js\"\nexport * from \"./Messages.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","'use strict';\nvar $ = require('../internals/export');\nvar iterate = require('../internals/iterate');\nvar aCallable = require('../internals/a-callable');\nvar anObject = require('../internals/an-object');\nvar getIteratorDirect = require('../internals/get-iterator-direct');\n\n// `Iterator.prototype.find` method\n// https://tc39.es/ecma262/#sec-iterator.prototype.find\n$({ target: 'Iterator', proto: true, real: true }, {\n  find: function find(predicate) {\n    anObject(this);\n    aCallable(predicate);\n    var record = getIteratorDirect(this);\n    var counter = 0;\n    return iterate(record, function (value, stop) {\n      if (predicate(value, counter++)) return stop(value);\n    }, { IS_RECORD: true, INTERRUPTED: true }).result;\n  }\n});\n"],"names":["class","key","ref","_createElementBlock","_hoisted_1","_createVNode","_component_SideNav","_createElementVNode","_hoisted_2","_hoisted_3","_component_router_link","to","name","default","_withCtx","_cache","_","$data","chat","_hoisted_4","src","otherUser","avatar","_hoisted_5","_hoisted_6","_toDisplayString","username","_hoisted_7","other_user_id","_createCommentVNode","_hoisted_8","loading","_hoisted_9","_component_Loader","_Fragment","_renderList","messages","message","id","_normalizeClass","sender_id","currentUserId","_createTextVNode","text","_hoisted_10","_ctx","$filters","timeago","created_at","_hoisted_11","onSubmit","_withModifiers","args","$options","sendMessage","$event","newMessage","type","placeholder","components","SideNav","defineAsyncComponent","Loader","data","chatId","undefined","methods","loadChat","this","warpnetService","getChat","error","console","loadMessages","getDirectMessages","cursorReset","trim","sendDirectMessage","receiverId","push","scrollToBottom","$nextTick","container","$refs","messageContainer","scrollTop","scrollHeight","created","log","$route","params","Promise","all","owner_id","getProfile","getImage","userId","avatar_key","__exports__","render","onClick","chats","length","getUser","selectChat","href","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","lastModified","_hoisted_18","last_message","showNewMessageModal","_createBlock","_component_NewMessageOverlay","profileId","onSelected","selected","loadMore","NewMessageOverlay","usersMap","Map","$router","user","existingChat","find","conv","newChat","createChat","get","loadChatUser","u","set","getChats","active","updated_at","gotoHome","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","ownerProfile","_hoisted_27","_hoisted_28","_hoisted_29","time","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","onKeyup","_withKeys","disabled","_hoisted_35","_hoisted_36","scrollToEnd","el","scrollToMe","scrollIntoView","behavior","input","setTimeout","focus","currentChat","participants","includes","warn","deselectAll","messagesResp","getOwnerProfile","activeChat","JSON","stringify","$","iterate","aCallable","anObject","getIteratorDirect","target","proto","real","predicate","record","counter","value","stop","IS_RECORD","INTERRUPTED","result"],"sourceRoot":""}