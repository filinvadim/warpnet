"use strict";(self["webpackChunkwarpnet_frontend"]=self["webpackChunkwarpnet_frontend"]||[]).push([[58],{5058:function(e,t,s){s.r(t),s.d(t,{default:function(){return te}});var i=s(641),l=s(33);const r={key:0},o={class:"pt-4 pl-4 flex flex-row"},a={class:"text-sm text-dark"},w={class:"w-full p-2 pt-1 pb-1 md:p-4 md:pt-2 md:pb-2 border-b hover:bg-lightest flex"},d={class:"flex-none mr-2 md:mr-4 pt-1"},n=["src"],u={class:"w-full"},h={class:"flex items-center w-full"},p={class:"font-semibold"},c={class:"hidden md:block text-sm text-dark ml-2"},f={class:"text-sm text-dark ml-2"},k={key:0,class:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1"},m={class:"pb-2"},y={class:"flex w-full"},x={class:"flex items-center text-sm text-dark w-1/4"},v={key:0},g={class:"flex items-center text-sm text-dark w-1/4"},b={key:0},L={class:"flex items-center text-sm text-dark w-1/4"},_={key:0};function C(e,t,s,C,R,T){const O=(0,i.g2)("ReplyOverlay");return(0,i.uX)(),(0,i.CE)(i.FK,null,[s.tweet.retweeted_by&&""!==s.tweet.retweeted_by?((0,i.uX)(),(0,i.CE)("div",r,[(0,i.Lk)("div",o,[t[7]||(t[7]=(0,i.Lk)("div",{class:"w-12 mr-4 flex justify-end"},[(0,i.Lk)("i",{class:"text-sm pt-1 fas fa-retweet text-dark"})],-1)),(0,i.Lk)("p",a,(0,l.v_)(R.label),1)])])):(0,i.Q3)("",!0),(0,i.Lk)("div",w,[(0,i.Lk)("div",d,[(0,i.Lk)("a",null,[(0,i.Lk)("img",{src:`${this.profile.avatar||"default_profile.png"}`,class:"h-12 w-12 rounded-full flex-none"},null,8,n)])]),(0,i.Lk)("div",u,[(0,i.Lk)("div",h,[(0,i.Lk)("a",{onClick:t[0]||(t[0]=e=>T.gotoProfile(s.tweet.user_id))},[(0,i.Lk)("p",p,(0,l.v_)(s.tweet.username),1)]),(0,i.Lk)("p",c," @"+(0,l.v_)(s.tweet.user_id),1),t[8]||(t[8]=(0,i.Lk)("p",{class:"text-sm text-dark ml-2"},"·",-1)),(0,i.Lk)("p",f,(0,l.v_)(e.$filters.timeago(s.tweet.created_at)),1),(0,i.Lk)("div",null,[(0,i.Lk)("i",{onClick:t[1]||(t[1]=e=>R.showDropdown=!R.showDropdown),class:"fas fa-angle-down text-sm ml-auto text-dark cursor-pointer"}),R.showDropdown?((0,i.uX)(),(0,i.CE)("div",k,[(0,i.Lk)("a",{onClick:t[2]||(t[2]=(...e)=>this.delete&&this.delete(...e)),class:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"},"Delete tweet")])):(0,i.Q3)("",!0)])]),(0,i.Lk)("p",m,(0,l.v_)(s.tweet.text),1),(0,i.Lk)("div",y,[(0,i.Lk)("div",x,[(0,i.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>T.replyToTweet&&T.replyToTweet(...e)),class:"mr-2 rounded-full hover:bg-lighter"},t[9]||(t[9]=[(0,i.Lk)("i",{class:"far fa-comment"},null,-1)])),T.getRepliesCount(s.tweet.id)>0?((0,i.uX)(),(0,i.CE)("p",v,(0,l.v_)(T.getRepliesCount(s.tweet.id)),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("div",g,[(0,i.Lk)("button",{onClick:t[4]||(t[4]=e=>T.retweet()),class:"mr-2 rounded-full hover:bg-lighter"},[(0,i.Lk)("i",{class:(0,l.C4)("fas fa-retweet "+(s.tweet.retweeted_by?"text-green-500":""))},null,2)]),T.getRetweetsCount(s.tweet.id)>0?((0,i.uX)(),(0,i.CE)("p",b,(0,l.v_)(T.getRetweetsCount(s.tweet.id)),1)):(0,i.Q3)("",!0)]),(0,i.Lk)("div",L,[(0,i.Lk)("button",{onClick:t[5]||(t[5]=e=>T.like()),class:"mr-2 rounded-full hover:bg-lighter"},[(0,i.Lk)("i",{class:(0,l.C4)("fas fa-heart "+(T.getLikesCount(s.tweet.id)>0?"text-red-600":""))},null,2)]),T.getLikesCount(s.tweet.id)>0?((0,i.uX)(),(0,i.CE)("p",_,(0,l.v_)(T.getLikesCount(s.tweet.id)),1)):(0,i.Q3)("",!0)]),t[10]||(t[10]=(0,i.Lk)("div",{class:"flex items-center text-sm text-dark w-1/4"},[(0,i.Lk)("i",{class:"fas fa-share-square mr-3"})],-1))])]),R.showReplyOverlay?((0,i.uX)(),(0,i.Wv)(O,{key:0,tweet:s.tweet,profile:R.profile,showReplyOverlay:R.showReplyOverlay,"onUpdate:showReplyOverlay":t[6]||(t[6]=e=>R.showReplyOverlay=e)},null,8,["tweet","profile","showReplyOverlay"])):(0,i.Q3)("",!0)])],64)}s(4114);var R=s(3751);const T={key:0,class:"fixed w-full h-full z-10 top-0 left-0 flex items-center justify-center"},O={class:"modal-main bg-white mx-auto rounded-lg z-0 overflow-y-auto",style:{width:"40%"}},I={class:"pl-1 pr-4 py-1 h-16 border-b-2 border-lightblue"},$={class:"flex flex-row mt-1 ml-4"},E={key:0,class:"border-l-2 border-r-2 border-white flex flex-col"},X={class:"p-3 flex flex-row"},Q={class:"flex-none mr-4"},D=["src"],M={class:"w-full"},P={class:"flex items-center w-full"},K={class:"font-semibold"},A={class:"text-sm text-dark ml-2"},N={class:"text-sm text-dark ml-2"},S={class:"py-2"},U={class:"p-3 flex flex-row"},j={class:"flex-none mr-4"},z=["src"],F={class:"w-full mb-2"},W=["disabled"];function q(e,t,s,r,o,a){const w=(0,i.g2)("Tweets"),d=(0,i.gN)("linkify");return s.showReplyOverlay?((0,i.uX)(),(0,i.CE)("div",T,[(0,i.Lk)("div",{class:"absolute w-full h-full bg-gray-900 opacity-50",onClick:t[0]||(t[0]=t=>e.$emit("update:showReplyOverlay",!1))}),(0,i.Lk)("div",O,[(0,i.Lk)("div",I,[(0,i.Lk)("div",$,[(0,i.Lk)("i",{onClick:t[1]||(t[1]=t=>e.$emit("update:showReplyOverlay",!1)),class:"fas fa-times text-blue text-2xl mb-8 mr-6 rounded-full bg-white p-2 px-3 hover:bg-lightblue cursor-pointer"})])]),s.profile?((0,i.uX)(),(0,i.CE)("div",E,[(0,i.Lk)("div",X,[(0,i.Lk)("div",Q,[(0,i.Lk)("img",{src:`${s.profile.avatar||"default_profile.png"}`,class:"h-12 w-12 rounded-full flex-none",alt:"Profile avatar"},null,8,D)]),(0,i.Lk)("div",M,[(0,i.Lk)("div",P,[(0,i.Lk)("p",K,(0,l.v_)(s.tweet.user_id),1),(0,i.Lk)("p",A," @"+(0,l.v_)(s.tweet.username),1),t[4]||(t[4]=(0,i.Lk)("p",{class:"text-sm text-dark ml-2"},"·",-1)),(0,i.Lk)("p",N,(0,l.v_)(e.$filters.timeago(s.tweet.created_at)),1)]),(0,i.bo)(((0,i.uX)(),(0,i.CE)("p",S,[(0,i.eW)((0,l.v_)(s.tweet.text),1)])),[[d]])])]),(0,i.Lk)("div",U,[(0,i.Lk)("div",j,[(0,i.Lk)("img",{src:`${s.profile.avatar||"default_profile.png"}`,class:"h-12 w-12 rounded-full flex-none",alt:"User avatar"},null,8,z)]),(0,i.Lk)("div",F,[(0,i.Lk)("form",{onSubmit:t[3]||(t[3]=(0,R.D$)(((...e)=>a.sendReply&&a.sendReply(...e)),["prevent"])),class:"w-full relative"},[(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":t[2]||(t[2]=e=>o.text=e),placeholder:"Tweet your reply",class:"w-full focus:outline-none mt-3 pb-3"},null,512),[[R.Jo,o.text]]),t[5]||(t[5]=(0,i.Lk)("div",null,[(0,i.Lk)("i",{class:"text-lg text-blue mr-4 far fa-image cursor-pointer"}),(0,i.Lk)("i",{class:"text-lg text-blue mr-4 fas fa-film cursor-pointer"}),(0,i.Lk)("i",{class:"text-lg text-blue mr-4 far fa-chart-bar cursor-pointer"}),(0,i.Lk)("i",{class:"text-lg text-blue mr-4 far fa-smile cursor-pointer"})],-1)),(0,i.Lk)("button",{type:"submit",class:(0,l.C4)(["h-10 px-4 text-white font-semibold bg-blue hover:bg-darkblue rounded-full absolute bottom-0 right-0",{"opacity-50 cursor-not-allowed":!o.text}]),disabled:!o.text}," Reply ",10,W)],32)])]),(0,i.Lk)("div",null,[(0,i.bF)(w,{tweets:this.replies},null,8,["tweets"])])])):(0,i.Q3)("",!0)])])):(0,i.Q3)("",!0)}var J=s(6278),V=s(2262),Y={name:"ReplyOverlay",components:{Tweets:V.A},props:["tweet","showReplyOverlay","profile"],data(){return{text:"",replies:[],repliesCursor:""}},methods:{...(0,J.i0)("warpnet",["replyTweet","getReplies"]),async sendReply(){await this.replyTweet({rootId:this.tweet.root_id||this.tweet.id,parentId:this.tweet.id,text:this.text}),this.$emit("update:showReplyOverlay",!1)},handleKeyup(e){"Escape"===e.key&&this.$emit("update:showReplyOverlay",!1)}},async created(){const e={rootId:this.tweet.root_id||this.tweet.id,parentId:this.tweet.id,limit:20,cursor:this.repliesCursor};let t=await this.getReplies(e);this.repliesCursor=t.cursor;for(const s of t.tree||[])this.replies.push(s.reply);window.addEventListener("keyup",this.handleKeyup)},beforeDestroy(){window.removeEventListener("keyup",this.handleKeyup)}},B=s(6262);const G=(0,B.A)(Y,[["render",q]]);var H=G,Z={name:"Tweet",props:["tweet"],components:{ReplyOverlay:H},data(){return{profile:{},likersCursor:"",retweetersCursor:"",showReplyOverlay:!1,showDropdown:!1,label:"You Retweeted",likesCount:new Map,retweetsCount:new Map,repliesCount:new Map,likers:new Map,retweeters:new Map}},methods:{...(0,J.i0)("warpnet",["getProfile","likeTweet","unlikeTweet","deleteTweet","getTweet","getTweetStats","getLikesNum","getLikers","retweetTweet","unretweetTweet","getRetweetsNum","getRetweeters","getTweetReply","deleteTweetReply"]),gotoProfile(e){this.$router.push({name:"Profile",params:{id:e}})},async get(){let e;if(this.tweet.parent_id&&this.tweet.parent_id!==this.tweet.root_id){const t={rootId:this.tweet.root_id,replyId:this.tweet.id};e=await this.getTweetReply(t)}else{const t={userId:this.tweet.user_id,tweetId:this.tweet.id};e=await this.getTweet(t)}this.showReplyOverlay=!0},async delete(){if(this.tweet.parent_id&&""!==this.tweet.parent_id){const e={userId:this.profile.id,rootId:this.tweet.root_id,replyId:this.tweet.id};await this.deleteTweetReply(e)}else{const e={userId:this.tweet.user_id,tweetId:this.tweet.id};await this.deleteTweet(e),this.gotoProfile(this.profile.id)}},replyToTweet(){this.showReplyOverlay=!0},async retweet(){let e=0;if(this.retweeters.has(this.tweet.id)){if(this.retweeters.get(this.tweet.id).has(this.tweet.user_id)&&""!==this.tweet.retweeted_by)e=await this.unretweetTweet(this.tweet.id).catch((e=>{console.error(`failed to unretweet [${this.tweet.id}]`,e)})),this.retweeters.get(this.tweet.id).delete(this.tweet.user_id);else{const t={tweetId:this.tweet.id,userId:this.tweet.user_id,username:this.tweet.username,text:this.tweet.text};e=await this.retweetTweet(t).catch((e=>{console.error(`failed to retweet [${this.tweet.id}]`,e)})),this.retweeters.get(this.tweet.id).set(this.tweet.user_id,this.profile)}this.retweetsCount.set(this.tweet.id,e)}else console.error("failed to retweet tweet",this.tweet.id)},async like(){let e=0;this.likers.has(this.tweet.id)?(this.likers.get(this.tweet.id).has(this.tweet.user_id)?(e=await this.unlikeTweet(this.tweet.id).catch((e=>{console.error(`failed to unlike tweet [${this.tweet.id}]`,e)})),this.likers.get(this.tweet.id).delete(this.tweet.user_id)):(e=await this.likeTweet(this.tweet.id).catch((e=>{console.error(`failed to like tweet [${this.tweet.id}]`,e)})),this.likers.get(this.tweet.id).set(this.tweet.user_id,this.profile)),this.likesCount.set(this.tweet.id,e)):console.error("failed to like tweet",this.tweet.id)},getLikesCount(e){return this.likesCount.get(e)},getRetweetsCount(e){return this.retweetsCount.get(e)},getRepliesCount(e){return this.repliesCount.get(e)}},async created(){this.profile=await this.getProfile(this.tweet.user_id),this.tweet.retweeted_by!==this.profile.id&&(this.label=`${this.tweet.username} Retweeted`),this.likers.set(this.tweet.id,null),this.retweeters.set(this.tweet.id,null);const e=await this.getTweetStats({tweetId:this.tweet.id,limit:20,cursor:""});this.likesCount.set(e.tweet_id,e.likes_count),this.retweetsCount.set(e.tweet_id,e.retweets_count),this.repliesCount.set(e.tweet_id,e.replies_count),this.likersCursor=e.likers.cursor;const t=new Map;for(const i of e.likers.users||[])t.set(i,null);this.likers.set(this.tweet.id,t),this.retweetersCursor=e.retweeters.cursor;const s=new Map;for(const i of e.retweeters.users||[])s.set(i,null);this.retweeters.set(this.tweet.id,s)}};const ee=(0,B.A)(Z,[["render",C]]);var te=ee}}]);
//# sourceMappingURL=58.d5a4fba9.js.map