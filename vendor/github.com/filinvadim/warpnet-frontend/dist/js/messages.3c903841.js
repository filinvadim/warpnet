"use strict";(self["webpackChunkwarpnet_frontend"]=self["webpackChunkwarpnet_frontend"]||[]).push([[871],{5587:function(e,t,s){s.d(t,{A:function(){return d}});var l=s(641);const o={key:0,class:"flex items-center justify-center"};function r(e,t,s,r,a,n){return s.loading?((0,l.uX)(),(0,l.CE)("div",o,t[0]||(t[0]=[(0,l.Lk)("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",width:"40px",height:"40px",viewBox:"0 0 40 40","enable-background":"new 0 0 40 40","xml:space":"preserve"},[(0,l.Lk)("path",{opacity:"0.2",fill:"#1da1f2",d:"M20.201,5.169c-8.254,0-14.946,6.692-14.946,14.946c0,8.255,6.692,14.946,14.946,14.946\n    s14.946-6.691,14.946-14.946C35.146,11.861,28.455,5.169,20.201,5.169z M20.201,31.749c-6.425,0-11.634-5.208-11.634-11.634\n    c0-6.425,5.209-11.634,11.634-11.634c6.425,0,11.633,5.209,11.633,11.634C31.834,26.541,26.626,31.749,20.201,31.749z"}),(0,l.Lk)("path",{fill:"#1da1f2",d:"M26.013,10.047l1.654-2.866c-2.198-1.272-4.743-2.012-7.466-2.012h0v3.312h0\n    C22.32,8.481,24.301,9.057,26.013,10.047z"},[(0,l.Lk)("animateTransform",{attributeType:"xml",attributeName:"transform",type:"rotate",from:"0 20 20",to:"360 20 20",dur:"0.5s",repeatCount:"indefinite"})])],-1)]))):(0,l.Q3)("",!0)}var a={name:"Loader",props:["loading"]},n=s(6262);const i=(0,n.A)(a,[["render",r]]);var d=i},5394:function(e,t,s){s.d(t,{A:function(){return T}});var l=s(641),o=s(3751),r=s(33);const a={class:"fixed w-full h-full top-0 left-0 flex items-center justify-center"},n={class:"modal-main bg-white mx-auto rounded-lg z-50 overflow-y-auto w-full sm:w-3/5 md:w-2/5 max-h-full"},i={class:"pl-1 pr-4 py-1 h-16 border-b-2 border-lightblue"},d={class:"flex flex-row mt-1 ml-4"},c={class:"border-l-2 border-r-2 border-white"},u={class:"p-3 flex flex-col border-b"},f={class:"lg:block w-full"},h={key:0,class:"flex flex-col items-center justify-center w-full pt-10"},g={class:"w-3/5"},m={class:"font-bold text-lg"};function p(e,t,s,p,v,x){const b=(0,l.g2)("Loader"),k=(0,l.g2)("ResultsNewMessage");return(0,l.uX)(),(0,l.CE)("div",a,[(0,l.Lk)("div",{class:"absolute w-full h-full bg-gray-900 opacity-50",onClick:t[0]||(t[0]=(0,o.D$)((t=>e.$emit("update:showNewMessageModal",!1)),["prevent"]))}),(0,l.Lk)("div",n,[(0,l.Lk)("div",i,[(0,l.Lk)("div",d,[(0,l.Lk)("i",{onClick:t[1]||(t[1]=t=>e.$emit("update:showNewMessageModal",!1)),class:"fas fa-times text-blue text-2xl w-10 h-10 mr-1 xl:mr-6 mt-1 pt-1 pl-3 rounded-full bg-white hover:bg-lightblue"}),t[4]||(t[4]=(0,l.Lk)("p",{class:"text-xl pt-1 font-bold mt-1"},"New message",-1))])]),(0,l.Lk)("div",c,[(0,l.Lk)("div",u,[(0,l.Lk)("div",f,[t[5]||(t[5]=(0,l.Lk)("i",{class:"fas fa-search absolute mt-3 ml-5 text-m text-light"},null,-1)),(0,l.bo)((0,l.Lk)("input",{class:"pl-12 rounded-full w-full p-2 bg-lighter text-m focus:bg-white focus:outline-none focus:ring-2 focus:ring-blue",placeholder:"Search People",type:"search","onUpdate:modelValue":t[2]||(t[2]=e=>v.query=e),onKeyup:t[3]||(t[3]=(0,o.jR)((e=>x.submit()),["enter"]))},null,544),[[o.Jo,v.query]])])]),(0,l.bF)(b,{loading:v.loading},null,8,["loading"]),!v.loading&&e.results&&0===e.results.length?((0,l.uX)(),(0,l.CE)("div",h,[(0,l.Lk)("div",g,[(0,l.Lk)("p",m,'No results for "'+(0,r.v_)(v.noResults)+'"',1),t[6]||(t[6]=(0,l.Lk)("p",{class:"text-sm text-dark"}," The query you entered did not bring up any results. ",-1))])])):(0,l.Q3)("",!0),(0,l.bF)(k,{results:e.results,onSelected:x.selected},null,8,["results","onSelected"])])])])}function v(e,t,s,o,r,a){const n=(0,l.g2)("UserNewMessage");return(0,l.uX)(),(0,l.CE)("div",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(s.results,(e=>((0,l.uX)(),(0,l.CE)("div",{key:e.id},[e.username?((0,l.uX)(),(0,l.Wv)(n,{key:0,user:e,onSelected:a.selected},null,8,["user","onSelected"])):(0,l.Q3)("",!0)])))),128))])}const x={class:"flex-none"},b=["src"],k={class:"ml-2 flex flex-col w-full"},w={class:"flex flex-row justify-between w-full"},L={class:"flex flex-col"},y={class:"font-bold"},C={class:"text-dark text-sm"};function M(e,t,s,o,a,n){return e.profile.id!==s.user.id?((0,l.uX)(),(0,l.CE)("div",{key:0,onClick:t[0]||(t[0]=e=>s.user.followedBy&&n.selected(s.user)),class:(0,r.C4)(["w-full px-4 py-2 border-b hover:bg-lightest flex flex-row cursor-pointer",s.user.followedBy?"":"cursor-not-allowed opacity-60"])},[(0,l.Lk)("div",x,[(0,l.Lk)("img",{src:`${s.user.avatar||"default_profile.png"}`,class:"h-12 w-12 rounded-full"},null,8,b)]),(0,l.Lk)("div",k,[(0,l.Lk)("div",w,[(0,l.Lk)("div",L,[(0,l.Lk)("p",y,(0,r.v_)(s.user.username),1),(0,l.Lk)("p",C," @"+(0,r.v_)(s.user.id)+" "+(0,r.v_)(s.user.followedBy?"":"cant'be messaged"),1)])])])],2)):(0,l.Q3)("",!0)}var E=s(6278),N={name:"User",props:["user"],computed:{...(0,E.L8)("warpnet",["profile"])},methods:{selected(e){this.$emit("selected",e)}}},_=s(6262);const $=(0,_.A)(N,[["render",M]]);var X=$,Q={name:"ResultsNewMessage",props:["results"],data(){return{cursorSearch:"",profile:{}}},components:{UserNewMessage:X},methods:{selected(e){this.$emit("selected",e)}}};const I=(0,_.A)(Q,[["render",v]]);var S=I,A=s(5587),R={name:"NewMessageOverlay",components:{ResultsNewMessage:S,Loader:A.A},props:["showNewMessageModal"],data(){return{loading:!0,query:"",noResults:"",mode:"People"}},computed:{...(0,E.L8)("warpnet",{results:"search"}),...(0,E.L8)("warpnet",["profile"])},methods:{...(0,E.i0)("warpnet",["loadProfile","loadSearch","loadMoreSearch","resetSearch"]),async openConversation(e){console.log(e),this.$emit("update:showNewMessageModal",!1)},async submit(){this.noResults=this.query,this.resetSearch(),await this.loadSearch({query:this.query,mode:this.mode,limit:20}).then((()=>{this.loading=!1}))},selected(e){this.$emit("selected",e)}},created(){window.addEventListener("keyup",(()=>{27===event.keyCode&&this.$emit("update:showNewMessageModal",!1)})),this.submit()},destroyed:function(){window.removeEventListener("keyup",(()=>{27===event.keyCode&&this.$emit("update:showNewMessageModal",!1)}))}};const U=(0,_.A)(R,[["render",p]]);var T=U},146:function(e,t,s){s.d(t,{A:function(){return A}});var l=s(641),o=s(33);const r={class:"w-1/6 md:w-1/12 xl:w-1/6 border-r border-lighter lg:px-6 py-2 flex-col justify-between hidden sm:flex"},a={key:0,class:"absolute -mt-6 ml-2"},n={class:"inline-flex items-center px-1.5 py-0.5 border-2 border-white rounded-full text-xs font-semibold leading-4 bg-blue text-white"},i={key:0,class:"absolute -mt-6 ml-2"},d={class:"inline-flex items-center px-1.5 py-0.5 border-2 border-white rounded-full text-xs font-semibold leading-4 bg-blue text-white"},c={key:0,class:"xl:w-full relative mt-2 w-10 h-10"},u=["src"],f={class:"hidden xl:block ml-4 truncate"},h={class:"text-left text-sm font-bold leading-tight truncate"},g={class:"text-left text-sm leading-tight text-dark truncate"},m={key:0,class:"absolute bottom-0 left-0 w-64 rounded-lg shadow-md border-lightest bg-white mb-16"},p=["src"],v={class:"ml-4"},x={class:"text-left text-sm font-bold leading-tight"},b={class:"text-left text-sm leading-tight text-dark"};function k(e,t,s,k,w,L){const y=(0,l.g2)("QRCodeModal");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("div",null,[(0,l.bF)(y,{show:e.qrModalOpen,qrData:e.qrCode,onClose:e.closeQRCodeModal},null,8,["show","qrData","onClose"])]),(0,l.Lk)("div",r,[(0,l.Lk)("div",null,[t[15]||(t[15]=(0,l.Lk)("button",{class:"h-12 w-12 hover:bg-lightblue text-3xl text-blue rounded-full"},null,-1)),(0,l.Lk)("div",null,[(0,l.Lk)("button",{onClick:t[0]||(t[0]=e=>L.open("Home")),class:"focus:outline-none hover:text-blue flex items-center px-4 py-2 hover:bg-transparent md:hover:bg-lightblue rounded-full mr-auto mb-1"},[(0,l.Lk)("i",{class:(0,o.C4)(["fa fa-home","Home"===e.$route.name?"text-2xl":"text-xl"]),"aria-hidden":"true"},null,2),(0,l.Lk)("p",{class:(0,o.C4)(["text-lg ml-4 text-left hidden xl:block","Home"===e.$route.name?"font-bold":""])}," Home ",2)]),t[12]||(t[12]=(0,l.Lk)("button",{class:"focus:outline-none hover:text-blue flex items-center px-4 py-2 hover:bg-transparent md:hover:bg-lightblue rounded-full mr-auto mb-1"},[(0,l.Lk)("i",{class:"fas fa-hashtag","aria-hidden":"true"}),(0,l.Lk)("p",{class:"text-lg ml-4 text-left hidden xl:block"},"Explore")],-1)),(0,l.Lk)("button",{onClick:t[1]||(t[1]=e=>L.open("Notifications")),class:"relative focus:outline-none hover:text-blue flex items-center px-4 py-2 hover:bg-transparent md:hover:bg-lightblue rounded-full mr-auto mb-1"},[(0,l.Lk)("i",{class:(0,o.C4)(["fa-bell","Notifications"===e.$route.name?"text-2xl fas":"text-xl far"]),"aria-hidden":"true"},null,2),w.newNotifications>0?((0,l.uX)(),(0,l.CE)("span",a,[(0,l.Lk)("div",n,(0,o.v_)(w.newNotifications),1)])):(0,l.Q3)("",!0),(0,l.Lk)("p",{class:(0,o.C4)(["text-lg ml-4 text-left hidden xl:block","Notifications"===e.$route.name?"font-bold":""])}," Notifications ",2)]),(0,l.Lk)("button",{onClick:t[2]||(t[2]=e=>L.open("Chats")),class:"focus:outline-none hover:text-blue flex items-center px-4 py-2 hover:bg-transparent md:hover:bg-lightblue rounded-full mr-auto mb-1"},[(0,l.Lk)("i",{class:(0,o.C4)(["fa-envelope","Chats"===e.$route.name?"text-2xl fas":"text-xl far"]),"aria-hidden":"true"},null,2),w.newMessages>0?((0,l.uX)(),(0,l.CE)("span",i,[(0,l.Lk)("div",d,(0,o.v_)(w.newMessages),1)])):(0,l.Q3)("",!0),(0,l.Lk)("p",{class:(0,o.C4)(["text-lg ml-4 text-left hidden xl:block","Chats"===e.$route.name?"font-bold":""])}," Messages ",2)]),t[13]||(t[13]=(0,l.Fv)('<button class="focus:outline-none hover:text-blue flex items-center px-4 py-2 hover:bg-transparent md:hover:bg-lightblue rounded-full mr-auto mb-1"><i class="text-xl far fa-bookmark" aria-hidden="true"></i><p class="text-lg ml-4 text-left hidden xl:block">Bookmarks</p></button><button class="focus:outline-none hover:text-blue flex items-center px-4 py-2 hover:bg-transparent md:hover:bg-lightblue rounded-full mr-auto mb-1"><i class="text-xl fas fa-clipboard-list" aria-hidden="true"></i><p class="text-lg ml-4 text-left hidden xl:block">Lists</p></button>',2)),(0,l.Lk)("button",{onClick:t[3]||(t[3]=e=>L.open("Profile")),class:"focus:outline-none hover:text-blue flex items-center px-4 py-2 hover:bg-transparent md:hover:bg-lightblue rounded-full mr-auto mb-1"},[(0,l.Lk)("i",{class:(0,o.C4)(["fa-user","Profile"===e.$route.name?"text-2xl fas":"text-xl far"]),"aria-hidden":"true"},null,2),(0,l.Lk)("p",{class:(0,o.C4)(["text-lg ml-4 text-left hidden xl:block","Profile"===e.$route.name?"font-bold":""])}," Profile ",2)]),(0,l.Lk)("button",{onClick:t[4]||(t[4]=()=>{}),class:"focus:outline-none hover:text-blue flex items-center px-4 py-2 hover:bg-transparent md:hover:bg-lightblue rounded-full mr-auto mb-1"},t[11]||(t[11]=[(0,l.Lk)("i",{class:"text-xl fas gear","aria-hidden":"true"},null,-1),(0,l.Lk)("p",{class:"text-lg ml-4 text-left hidden xl:block"},"Settings",-1)]))]),(0,l.Lk)("button",{onClick:t[5]||(t[5]=e=>L.open("Home")),class:"text-white bg-blue rounded-full font-semibold h-12 lg:h-auto w-12 xl:w-full hover:bg-darkblue p-3"},t[14]||(t[14]=[(0,l.Lk)("p",{class:"hidden xl:block"},"Tweet",-1),(0,l.Lk)("i",{class:"fas fa-plus xl:hidden"},null,-1)]))]),w.profile?((0,l.uX)(),(0,l.CE)("div",c,[(0,l.Lk)("button",{onClick:t[6]||(t[6]=e=>w.dropdown=!w.dropdown),class:"flex items-center w-full hover:bg-lightblue rounded-full"},[(0,l.Lk)("img",{src:w.profile.avatar||"default_profile.png",class:"w-10 h-10 rounded-full",alt:"Profile avatar"},null,8,u),(0,l.Lk)("div",f,[(0,l.Lk)("div",h,(0,o.v_)(w.profile.username),1),(0,l.Lk)("div",g,(0,o.v_)(w.profile.id),1)]),t[16]||(t[16]=(0,l.Lk)("i",{class:"hidden xl:block fas fa-angle-down ml-auto text-lg"},null,-1))]),w.dropdown?((0,l.uX)(),(0,l.CE)("div",m,[(0,l.Lk)("button",{onClick:t[7]||(t[7]=e=>w.dropdown=!1),class:"p-3 flex items-center w-full hover:bg-lightest"},[(0,l.Lk)("img",{src:w.profile.avatar||"default_profile.png",class:"w-10 h-10 rounded-full",alt:"Profile avatar"},null,8,p),(0,l.Lk)("div",v,[(0,l.Lk)("p",x,(0,o.v_)(w.profile.username),1),(0,l.Lk)("p",b,(0,o.v_)(w.profile.id),1)]),t[17]||(t[17]=(0,l.Lk)("i",{class:"fas fa-check ml-auto text-blue"},null,-1))]),(0,l.Lk)("button",{class:"w-full text-left hover:bg-lightest border-t border-lighter p-3 text-sm",onClick:t[8]||(t[8]=(...e)=>L.toggleDarkMode&&L.toggleDarkMode(...e))}," Toggle Theme "),t[18]||(t[18]=(0,l.Lk)("button",{class:"w-full text-left hover:bg-lightest border-t border-lighter p-3 text-sm"}," Add an existing account ",-1)),(0,l.Lk)("button",{onClick:t[9]||(t[9]=(...e)=>L.signInByQR&&L.signInByQR(...e)),class:"w-full text-left hover:bg-lightest border-t border-lighter p-3 text-sm"}," Sign in by QR-code "),(0,l.Lk)("button",{onClick:t[10]||(t[10]=(...e)=>L.signOut&&L.signOut(...e)),class:"w-full text-left hover:bg-lightest border-t border-lighter p-3 text-sm"}," Log out "+(0,o.v_)(w.profile.username),1)])):(0,l.Q3)("",!0)])):(0,l.Q3)("",!0)])],64)}s(4114);var w=s(3751);const L={class:"bg-white rounded-lg shadow-lg p-6 w-80 relative"},y={key:0,class:"flex justify-center mb-4"},C=["src"],M={key:1,class:"text-center text-gray-500"};function E(e,t,s,o,r,a){return s.show?((0,l.uX)(),(0,l.CE)("div",{key:0,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",onClick:t[1]||(t[1]=(0,w.D$)(((...e)=>a.close&&a.close(...e)),["self"]))},[(0,l.Lk)("div",L,[(0,l.Lk)("button",{class:"absolute top-2 right-2 text-gray-500 hover:text-gray-700",onClick:t[0]||(t[0]=(...e)=>a.close&&a.close(...e))},t[2]||(t[2]=[(0,l.Lk)("i",{class:"fas fa-times"},null,-1)])),t[4]||(t[4]=(0,l.Lk)("h3",{class:"text-xl font-semibold text-center mb-4"},"Your QR Code",-1)),s.qrData?((0,l.uX)(),(0,l.CE)("div",y,[(0,l.Lk)("img",{src:s.qrData,alt:"QR Code",class:"w-48 h-48"},null,8,C)])):((0,l.uX)(),(0,l.CE)("div",M,t[3]||(t[3]=[(0,l.Lk)("p",null,"No QR code is currently available. Please try again later.",-1)]))),t[5]||(t[5]=(0,l.Lk)("p",{class:"text-sm text-gray-600 text-center"}," Scan this QR code with your app to log in. ",-1))])])):(0,l.Q3)("",!0)}var N=s(6278),_={props:{show:{type:Boolean,required:!0},qrData:{type:String,required:!1}},methods:{...(0,N.i0)("authentication",["closeQRCodeModal"]),close(){this.closeQRCodeModal()},handleEscape(e){"Escape"===e.key&&this.close()}},mounted(){window.addEventListener("keydown",this.handleEscape)},beforeDestroy(){window.removeEventListener("keydown",this.handleEscape)}},$=s(6262);const X=(0,$.A)(_,[["render",E]]);var Q=X,I={name:"SideNav",data(){return{dropdown:!1,profile:{},newMessages:0,newNotifications:0}},async created(){this.profile=await this.getOwnerProfile()},mounted(){const e=localStorage.getItem("theme");"dark"===e||!e&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},components:{QRCodeModal:Q},computed:{...(0,N.L8)("authentication",["qrCode","qrModalOpen"])},methods:{...(0,N.i0)("authentication",["logoutUser","closeQRCodeModal","openQRCodeModal"]),...(0,N.i0)("warpnet",["getOwnerProfile"]),async open(e){const t=this.$route.name;e===t&&this.$route.params.id===this.profile.id||this.$router.push({name:e,params:{id:this.profile.id}})},toggleDarkMode(){const e=document.documentElement;e.classList.contains("dark")?(e.classList.remove("dark"),localStorage.setItem("theme","light")):(e.classList.add("dark"),localStorage.setItem("theme","dark"))},async signInByQR(){try{console.log("signing in by QR..."),await this.openQRCodeModal(),console.log("QR code modal:",this.qrModalOpen)}catch(e){alert("Error signing in by QR, please check console to read the error details"),console.log("Error signing in by QR:",e)}},async signOut(){try{await this.logoutUser()}catch(e){alert("Error signing out, please check console for error details"),console.log("Error signing out:",e)}}}};const S=(0,$.A)(I,[["render",k]]);var A=S},621:function(e,t,s){s.r(t),s.d(t,{default:function(){return C}});var l=s(641),o=s(33),r=s(3751);const a={class:"flex container h-full w-full"},n={class:"flex-1 flex flex-col h-full"},i={class:"px-4 py-3 border-b border-lighter flex items-center"},d={key:0,class:"flex items-center"},c=["src"],u={class:"font-bold"},f={class:"text-sm text-dark"},h={class:"flex-1 overflow-y-auto p-4",ref:"messageContainer"},g={key:0,class:"flex justify-center"},m={class:"text-xs mt-1 text-gray-500"},p={class:"border-t border-lighter px-4 py-3"};function v(e,t,s,v,x,b){const k=(0,l.g2)("SideNav"),w=(0,l.g2)("router-link"),L=(0,l.g2)("Loader"),y=(0,l.gN)("linkify");return(0,l.uX)(),(0,l.CE)("div",a,[(0,l.bF)(k),(0,l.Lk)("div",n,[(0,l.Lk)("div",i,[(0,l.bF)(w,{to:{name:"conversations"},class:"mr-4"},{default:(0,l.k6)((()=>t[2]||(t[2]=[(0,l.Lk)("i",{class:"fas fa-arrow-left text-xl text-blue"},null,-1)]))),_:1}),x.conversation?((0,l.uX)(),(0,l.CE)("div",d,[(0,l.Lk)("img",{src:x.conversation.otherUser.avatar||"default_profile.png",class:"w-10 h-10 rounded-full mr-3"},null,8,c),(0,l.Lk)("div",null,[(0,l.Lk)("p",u,(0,o.v_)(x.conversation.otherUser.username),1),(0,l.Lk)("p",f,"@"+(0,o.v_)(x.conversation.otherUser.id),1)])])):(0,l.Q3)("",!0)]),(0,l.Lk)("div",h,[x.loading?((0,l.uX)(),(0,l.CE)("div",g,[(0,l.bF)(L,{loading:x.loading},null,8,["loading"])])):((0,l.uX)(!0),(0,l.CE)(l.FK,{key:1},(0,l.pI)(x.messages,(t=>((0,l.uX)(),(0,l.CE)("div",{key:t.id,class:(0,o.C4)(["mb-4 flex",{"justify-end":t.senderId===e.currentUserId}])},[(0,l.Lk)("div",{class:(0,o.C4)(["max-w-3/4 rounded-lg px-4 py-2",t.senderId===e.currentUserId?"bg-blue text-white":"bg-lighter"])},[(0,l.bo)(((0,l.uX)(),(0,l.CE)("p",null,[(0,l.eW)((0,o.v_)(t.content),1)])),[[y]]),(0,l.Lk)("p",m,(0,o.v_)(e.$filters.timeago(t.createdAt)),1)],2)],2)))),128))],512),(0,l.Lk)("div",p,[(0,l.Lk)("form",{onSubmit:t[1]||(t[1]=(0,r.D$)(((...e)=>b.sendMessage&&b.sendMessage(...e)),["prevent"])),class:"flex"},[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>x.newMessage=e),type:"text",placeholder:"Type a message...",class:"flex-1 rounded-full border border-lighter px-4 py-2 mr-2"},null,512),[[r.Jo,x.newMessage]]),t[3]||(t[3]=(0,l.Lk)("button",{type:"submit",class:"bg-blue text-white rounded-full px-6 py-2"}," Send ",-1))],32)])])])}s(4114);var x=s(6278),b=s(146),k=s(5587),w={name:"Conversation",components:{SideNav:b.A,Loader:k.A},data(){return{loading:!0,conversation:null,messages:[],newMessage:"",messagesCursor:null}},computed:{...(0,x.aH)({currentUserId:e=>e.auth.user.id}),chatId(){return this.$route.params.chatId}},methods:{async loadConversation(){try{this.conversation=await this.$store.dispatch("getConversation",{conversationId:this.chatId})}catch(e){console.error("Error loading conversation:",e)}},async loadMessages(){try{const{messages:e,cursor:t}=await this.$store.dispatch("getMessages",{conversationId:this.chatId,cursor:this.messagesCursor,limit:50});this.messages=[...e,...this.messages],this.messagesCursor=t,this.loading=!1}catch(e){console.error("Error loading messages:",e),this.loading=!1}},async sendMessage(){if(this.newMessage.trim())try{const e=await this.$store.dispatch("sendMessage",{conversationId:this.chatId,content:this.newMessage});this.messages.push(e),this.newMessage="",this.scrollToBottom()}catch(e){console.error("Error sending message:",e)}},scrollToBottom(){this.$nextTick((()=>{const e=this.$refs.messageContainer;e.scrollTop=e.scrollHeight}))}},async created(){await Promise.all([this.loadConversation(),this.loadMessages()]),this.scrollToBottom()}},L=s(6262);const y=(0,L.A)(w,[["render",v]]);var C=y},2450:function(e,t,s){s.r(t),s.d(t,{default:function(){return X}});var l=s(641),o=s(33);const r={id:"app",class:"flex container h-full w-full"},a={class:"flex container h-full w-full"},n={class:"w-full sm:w-1/3 md:w-1/2 lg:w-1/2 h-full overflow-y-scroll no-scrollbar hidden md:block"},i={class:"px-5 py-3 border-b border-lighter flex"},d={key:0},c={key:0,class:"flex flex-col items-center justify-center w-full pt-10"},u={class:"cursor-pointer"},f=["onClick"],h={class:"flex-none mr-2 md:mr-4 pt-1"},g=["href"],m=["src"],p={class:"w-full truncate"},v={class:"flex items-center w-full"},x={class:"font-semibold"},b={class:"hidden md:block text-sm text-dark ml-2 truncate"},k={class:"text-sm text-dark ml-auto"},w={class:"pb-2 truncate"};function L(e,t,s,L,y,C){const M=(0,l.g2)("SideNav"),E=(0,l.g2)("Loader"),N=(0,l.g2)("NewMessageOverlay"),_=(0,l.gN)("linkify");return(0,l.uX)(),(0,l.CE)("div",r,[(0,l.Lk)("div",a,[(0,l.bF)(M),(0,l.Lk)("div",n,[(0,l.Lk)("div",i,[t[1]||(t[1]=(0,l.Lk)("h1",{class:"text-xl font-bold flex-1"},"Conversations",-1)),t[2]||(t[2]=(0,l.Lk)("i",{class:"fas fa-cog text-xl text-blue cursor-pointer"},null,-1)),(0,l.Lk)("i",{onClick:t[0]||(t[0]=e=>C.newMessage()),class:"fas fa-plus-circle ml-3 text-xl text-blue cursor-pointer"})]),(0,l.bF)(E,{loading:y.loading},null,8,["loading"]),y.loading?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",d,[0===y.conversations.length?((0,l.uX)(),(0,l.CE)("div",c,t[3]||(t[3]=[(0,l.Lk)("div",{class:"w-1/2 flex flex-col items-center justify-center"},[(0,l.Lk)("p",{class:"font-bold text-lg"},"No conversations yet"),(0,l.Lk)("p",{class:"text-sm text-dark"}," Wait until someone starts a conversation here. ")],-1)]))):(0,l.Q3)("",!0),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(y.conversations,(t=>((0,l.uX)(),(0,l.CE)("div",{key:t.id},[(0,l.Lk)("div",u,[(0,l.Lk)("div",{class:"w-full p-2 pt-1 pb-1 md:p-4 md:pt-2 md:pb-2 border-b hover:bg-lightest flex",onClick:e=>C.selectConversation(t)},[(0,l.Lk)("div",h,[(0,l.Lk)("a",{href:`#/${t.otherUser.username}`},[(0,l.Lk)("img",{src:`${t.otherUser.avatar||"default_profile.png"}`,class:"h-12 w-12 rounded-full flex-none"},null,8,m)],8,g)]),(0,l.Lk)("div",p,[(0,l.Lk)("div",v,[(0,l.Lk)("p",x,(0,o.v_)(t.otherUser.username),1),(0,l.Lk)("p",b," @"+(0,o.v_)(t.otherUser.id),1),(0,l.Lk)("p",k,(0,o.v_)(e.$filters.timeago(t.lastModified)),1)]),(0,l.bo)(((0,l.uX)(),(0,l.CE)("p",w,[(0,l.eW)((0,o.v_)(t.lastMessage),1)])),[[_]])])],8,f)])])))),128))]))]),t[4]||(t[4]=(0,l.Lk)("div",{class:"w-full border-l border-r border-lighter h-screen flex items-center justify-center"},[(0,l.Lk)("div",{class:"text-center"},[(0,l.Lk)("h2",{class:"text-2xl font-bold mb-4"},"Select a conversation"),(0,l.Lk)("p",{class:"text-gray-600"},"Choose a conversation from the list to start chatting")])],-1)),y.showNewMessageModal?((0,l.uX)(),(0,l.Wv)(N,{key:0,showNewMessageModal:y.showNewMessageModal,onSelected:C.selected},null,8,["showNewMessageModal","onSelected"])):(0,l.Q3)("",!0)])])}s(4114),s(8111),s(116);var y=s(146),C=s(5587),M=s(5394),E=s(6278),N={name:"Conversations",components:{SideNav:y.A,Loader:C.A,NewMessageOverlay:M.A},data(){return{loading:!0,showNewMessageModal:!1,conversations:[],conversationsCursor:"",profile:{}}},methods:{...(0,E.i0)("warpnet",["createConversation","deleteConversation","getConversations"]),newMessage(){this.showNewMessageModal=!0},async selectConversation(e){this.$router.push({name:"Messages",params:{chatId:e.id}})},async selected(e){if(!e.id)return;this.showNewMessageModal=!1;const t=this.conversations.find((t=>t.otherUser.id===e.id));if(t)await this.selectConversation(t);else{const t=await this.createConversation({otherUserId:e.id});t&&await this.selectConversation(t)}},async loadConversations(){try{const{conversations:e,cursor:t}=await this.getConversations({limit:20,cursor:this.conversationsCursor});this.conversations=[...this.conversations,...e],this.conversationsCursor=t,this.loading=!1}catch(e){console.error("Error loading conversations:",e),this.loading=!1}}},async created(){await this.loadConversations()}},_=s(6262);const $=(0,_.A)(N,[["render",L]]);var X=$},1345:function(e,t,s){s.r(t),s.d(t,{default:function(){return ae}});var l=s(641),o=s(33),r=s(3751);const a={id:"app",class:"flex container h-full w-full"},n={class:"flex container h-full w-full"},i={class:"w-full sm:w-1/3 md:w-1/2 lg:w-1/2 h-full overflow-y-scroll no-scrollbar hidden md:block"},d={key:0},c={key:0,class:"flex flex-col items-center justify-center w-full pt-10"},u=["onClick"],f={class:"flex-none mr-2 md:mr-4 pt-1"},h=["href"],g=["src"],m={class:"w-full truncate"},p={class:"flex items-center w-full"},v={class:"font-semibold"},x={class:"hidden md:block text-sm text-dark ml-2 truncate"},b={class:"text-sm text-dark ml-auto"},k={class:"pb-2 truncate"},w={key:0,class:"w-full z-0 h-screen border-l border-r border-lighter overflow-y-scroll no-scrollbar relative flex flex-col items-center justify-center",style:{display:"grid","grid-template-rows":"53px auto"}},L={class:"flex flex-col items-center justify-center w-full"},y={class:"w-3/5"},C={class:"flex justify-start mt-5"},M={key:1,class:"w-full border-l border-r border-lighter h-screen",style:{display:"grid","grid-template-rows":"53px auto 53px"}},E={class:"flex-none mr-4"},N=["href"],_=["src"],$={class:"w-full flex flex-col"},X={class:"text-m font-bold flex-1"},Q={class:"text-dark text-xs"},I={class:"w-full pt-5 overflow-y-scroll no-scrollbar",style:{display:"grid","grid-template-rows":"auto"}},S={class:"w-full px-5 flex flex-col justify-between"},A={class:"flex flex-col-reverse mt-1 h-full",style:{"min-height":"100%"}},R={ref:"scrollToMe"},U={key:0},T={class:"flex justify-end"},j={class:"mr-2 py-3 px-4 bg-blue rounded-bl-3xl rounded-tl-3xl rounded-tr-xl text-white"},D={class:"flex justify-end w-full mb-4"},q={class:"text-xs text-dark mr-2"},P={key:1},F={class:"flex justify-start"},O={class:"flex-none mr-4"},B=["href"],H=["src"],K={class:"ml-2 py-3 px-4 bg-lighter rounded-br-3xl rounded-tr-3xl rounded-tl-xl text-black"},W={class:"flex items-center w-full mb-4"},z={class:"text-xs text-dark ml-14"},V={class:"bg-white px-5 p-3 border-t border-lighter flex w-full"},J=["disabled"],Y=["disabled"];function G(e,t,s,G,Z,ee){const te=(0,l.g2)("SideNav"),se=(0,l.g2)("Loader"),le=(0,l.g2)("NewMessageOverlay"),oe=(0,l.gN)("linkify"),re=(0,l.gN)("scroll");return(0,l.uX)(),(0,l.CE)("div",a,[(0,l.Lk)("div",n,[(0,l.bF)(te),(0,l.Lk)("div",i,[(0,l.Lk)("div",{class:"px-5 py-3 border-b border-lighter flex",onClick:t[1]||(t[1]=e=>ee.deselectAll())},[t[9]||(t[9]=(0,l.Lk)("h1",{class:"text-xl font-bold flex-1"},"Messages",-1)),t[10]||(t[10]=(0,l.Lk)("i",{class:"fas fa-cog text-xl text-blue cursor-pointer"},null,-1)),(0,l.Lk)("i",{onClick:t[0]||(t[0]=e=>ee.newMessage()),class:"fas fa-plus-circle ml-3 text-xl text-blue cursor-pointer"})]),(0,l.bF)(se,{loading:Z.loading},null,8,["loading"]),Z.loading?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",d,[0===e.conversations.length?((0,l.uX)(),(0,l.CE)("div",c,t[11]||(t[11]=[(0,l.Lk)("div",{class:"w-1/2 flex flex-col items-center justify-center"},[(0,l.Lk)("p",{class:"font-bold text-lg"},"No conversations yet"),(0,l.Lk)("p",{class:"text-sm text-dark"}," Wait until someone starts a conversation here. ")],-1)]))):(0,l.Q3)("",!0),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.conversations,(t=>((0,l.uX)(),(0,l.CE)("div",{key:t.id},[(0,l.Lk)("div",{class:(0,o.C4)(["cursor-pointer",e.active&&t.id===e.active.id?"border-r-2 border-blue":""])},[(0,l.Lk)("div",{class:"w-full p-2 pt-1 pb-1 md:p-4 md:pt-2 md:pb-2 border-b hover:bg-lightest flex",style:(0,o.Tr)(e.hasNewMessages(t)?"background-color:#e1f5fe;":""),onClick:e=>ee.selectConversation(t)},[(0,l.Lk)("div",f,[(0,l.Lk)("a",{href:`#/${t.otherUser.username}`},[(0,l.Lk)("img",{src:`${t.otherUser.avatar||"default_profile.png"}`,class:"h-12 w-12 rounded-full flex-none"},null,8,g)],8,h)]),(0,l.Lk)("div",m,[(0,l.Lk)("div",p,[(0,l.Lk)("p",v,(0,o.v_)(t.otherUser.id),1),(0,l.Lk)("p",x," @"+(0,o.v_)(t.otherUser.username||"Anonymous"),1),(0,l.Lk)("p",b,(0,o.v_)(e.$filters.timeago(t.lastModified)),1)]),(0,l.bo)(((0,l.uX)(),(0,l.CE)("p",k,[(0,l.eW)((0,o.v_)(t.lastMessage),1)])),[[oe]])])],12,u)],2)])))),128))]))]),Z.loading||!e.active?((0,l.uX)(),(0,l.CE)("div",w,[(0,l.Lk)("div",{class:(0,o.C4)(["top-0 left-0 w-full px-5 pt-1 pb-2 border-lighter flex bg-white",e.active?"border-b":""])},[(0,l.Lk)("button",{onClick:t[2]||(t[2]=e=>ee.gotoHome()),class:"block md:hidden rounded-full mr-2 focus:outline-none hover:bg-lightblue"},t[12]||(t[12]=[(0,l.Lk)("i",{class:"fas fa-arrow-left text-blue"},null,-1)]))],2),(0,l.Lk)("div",L,[(0,l.Lk)("div",y,[t[13]||(t[13]=(0,l.Lk)("p",{class:"font-bold text-lg"},"You don’t have a message selected",-1)),t[14]||(t[14]=(0,l.Lk)("p",{class:"text-sm text-dark"}," This is where you’ll see messages from people you don’t follow. They won’t know you’ve seen the request until you accept it. ",-1)),(0,l.Lk)("div",C,[(0,l.Lk)("button",{onClick:t[3]||(t[3]=e=>ee.newMessage()),type:"button",class:"h-10 px-2 text-white font-semibold bg-blue hover:bg-darkblue rounded-full"}," New Message ")])])])])):(0,l.Q3)("",!0),!Z.loading&&e.active?((0,l.uX)(),(0,l.CE)("div",M,[(0,l.Lk)("div",{class:"px-5 pt-1 pb-2 border-b border-lighter flex bg-white sticky",onClick:t[5]||(t[5]=t=>{ee.deselectAll(),e.active=void 0})},[(0,l.Lk)("button",{onClick:t[4]||(t[4]=e=>ee.gotoHome()),class:"block md:hidden rounded-full mr-2 focus:outline-none hover:bg-lightblue"},t[15]||(t[15]=[(0,l.Lk)("i",{class:"fas fa-arrow-left text-blue"},null,-1)])),(0,l.Lk)("div",E,[(0,l.Lk)("a",{href:`#/${e.active.other_user_id}`},[(0,l.Lk)("img",{src:`${e.active.otherUser.avatar||"default_profile.png"}`,class:"flex-none w-6 h-6 rounded-full mt-2"},null,8,_)],8,N)]),(0,l.Lk)("div",$,[(0,l.Lk)("h1",X,(0,o.v_)(e.active.otherUser.username),1),(0,l.Lk)("p",Q,"@"+(0,o.v_)(e.active.otherUser.id),1)]),t[16]||(t[16]=(0,l.Lk)("i",{class:"fas fa-info-circle ml-3 text-xl text-blue mt-2 cursor-pointer"},null,-1))]),(0,l.bo)(((0,l.uX)(),(0,l.CE)("div",I,[(0,l.Lk)("div",S,[(0,l.Lk)("div",A,[(0,l.Lk)("div",R,null,512),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.messages,(t=>((0,l.uX)(),(0,l.CE)("div",{key:t.id},[e.isMyMessage(t.owner_id)?((0,l.uX)(),(0,l.CE)("div",U,[(0,l.Lk)("div",T,[(0,l.Lk)("div",j,(0,o.v_)(t.text),1)]),(0,l.Lk)("div",D,[(0,l.Lk)("p",q,(0,o.v_)(e.$filters.time(t.created_at)),1)])])):(0,l.Q3)("",!0),e.isMyMessage(t.other_user_id)?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",P,[(0,l.Lk)("div",F,[(0,l.Lk)("div",O,[(0,l.Lk)("a",{href:`#/${t.other_user_id}`},[(0,l.Lk)("img",{src:`${t.from.avatar||"default_profile.png"}`,class:"object-cover h-8 w-8 rounded-full self-end"},null,8,H)],8,B)]),(0,l.Lk)("div",K,(0,o.v_)(t.text),1)]),(0,l.Lk)("div",W,[(0,l.Lk)("p",z,(0,o.v_)(e.$filters.time(t.created_at)),1)])]))])))),128))])])])),[[re,ee.loadMore,"top"]]),(0,l.Lk)("div",V,[(0,l.bo)((0,l.Lk)("input",{ref:"input",class:"pl-5 rounded-full w-full p-2 bg-lighter text-sm focus:bg-white focus:outline-none focus:ring-2 focus:ring-blue",placeholder:"Start a new message",type:"search","onUpdate:modelValue":t[6]||(t[6]=e=>Z.text=e),onKeyup:t[7]||(t[7]=(0,r.jR)((e=>ee.sendMessage()),["enter"])),disabled:Z.disabled},null,40,J),[[r.Jo,Z.text]]),(0,l.Lk)("button",{class:(0,o.C4)(["rounded-full focus:outline-none right-4 ml-4 w-8 h-8",""+(0===Z.text.length?"opacity-50 cursor-default":"hover:bg-lightblue")]),onClick:t[8]||(t[8]=e=>ee.sendMessage()),disabled:Z.disabled},t[17]||(t[17]=[(0,l.Lk)("i",{class:"fas fa-arrow-right text-xl text-blue"},null,-1)]),10,Y)])])):(0,l.Q3)("",!0),Z.showNewMessageModal?((0,l.uX)(),(0,l.Wv)(le,{key:2,showNewMessageModal:Z.showNewMessageModal,onSelected:ee.selected},null,8,["showNewMessageModal","onSelected"])):(0,l.Q3)("",!0)])])}s(4114),s(8111),s(7588);var Z=s(146),ee=s(5587),te=s(5394),se=s(6278),le={name:"Messages",components:{SideNav:Z.A,Loader:ee.A,NewMessageOverlay:te.A},data(){return{loading:!0,text:"",disabled:!1,showNewMessageModal:!1,lastNextToken:void 0}},computed:{...(0,se.L8)("warpnet",{isMyMessage:"isSelf",active:"conversation",userProfile:"profile"}),...(0,se.L8)("warpnet",["conversations","messages","hasNewMessages","cursorMessages"]),...(0,se.L8)("warpnet",["profile","conversationExists"])},methods:{...(0,se.i0)("authentication",["loginUserIfAlreadyAuthenticated"]),...(0,se.i0)("warpnet",["createConversation","deleteConversation","loadConversations","getDirectMessages","sendDirectMessage","setActiveConversation","loadMoreDirectMessages"]),...(0,se.i0)("warpnet",["loadProfile"]),newMessage(){this.showNewMessageModal=!0},gotoHome(){this.$router.push({name:"Home"})},async selectConversation(e){this.setActiveConversation(e),await this.getDirectMessages({chatId:e.id,limit:20,cursor:""}),this.scrollToEnd()},sendMessage(){this.active.otherUser.id&&0!==this.message.length&&(this.disabled=!0,this.sendDirectMessage({chatId:this.active.id,text:this.message,otherUserId:this.active.otherUser.id}).then((()=>{this.message="",this.disabled=!1,this.$nextTick((()=>{this.scrollToEnd()}))})))},scrollToEnd(){this.$nextTick((()=>{const e=this.$refs.scrollToMe;e&&e.scrollIntoView({behavior:"smooth"}),setTimeout((()=>this.$refs.input.focus()),500)}))},async selected(e){if(!this.userProfile.id||!e.id)return;let t;if(this.showNewMessageModal=!1,this.conversations.forEach((e=>{this.conversationExists(e.id)&&(t=e)})),t)await this.selectConversation(t);else{let t={id:null,lastMessage:void 0,lastModified:void 0,otherUser:{...e}};this.setActiveConversation(t),await this.selectConversation(t)}},deselectAll(){this.setActiveConversation(void 0)},async loadMore(){this.active&&await this.loadMoreDirectMessages({chatId:this.active.id,limit:20}).catch((e=>{console.log(e)}))}},async created(){this.conversations.length>0&&(this.loading=!1),this.conversation&&this.scrollToEnd(),await this.loginUserIfAlreadyAuthenticated(),await this.loadConversations({limit:20,cursor:""}).then((()=>this.loading=!1)),this.profile.id!==this.userProfile.id&&await this.selected(this.profile)}},oe=s(6262);const re=(0,oe.A)(le,[["render",G]]);var ae=re},116:function(e,t,s){var l=s(6518),o=s(2652),r=s(9306),a=s(8551),n=s(1767);l({target:"Iterator",proto:!0,real:!0},{find:function(e){a(this),r(e);var t=n(this),s=0;return o(t,(function(t,l){if(e(t,s++))return l(t)}),{IS_RECORD:!0,INTERRUPTED:!0}).result}})},7588:function(e,t,s){var l=s(6518),o=s(2652),r=s(9306),a=s(8551),n=s(1767);l({target:"Iterator",proto:!0,real:!0},{forEach:function(e){a(this),r(e);var t=n(this),s=0;o(t,(function(t){e(t,s++)}),{IS_RECORD:!0})}})}}]);
//# sourceMappingURL=messages.3c903841.js.map