/* License generated by licensor(https://github.com/Marvin9/licensor).

 Warpnet - Decentralized Social Network
 Copyright (C) 2025 Vadim Filin, https://github.com/filinvadim,
 <github.com.mecdy@passmail.net>
 
 This program is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.
 
 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.
 
 You should have received a copy of the GNU General Public License
 along with this program.  If not, see <https://www.gnu.org/licenses/>.
*/

package main

import (
	"flag"
	"log"
	"os"
)

const (
	deprecatedFlagProgOnly = "prog_only"
	deprecatedFlagExecOnly = "exec_only"
)

var (
	_ = flag.Bool("prog_only", false, "DEPRECATED (reflect mode) Only generate the reflection program; write it to stdout and exit.")
	_ = flag.String("exec_only", "", "DEPRECATED (reflect mode) If set, execute this reflection program.")
)

// notifyAboutDeprecatedFlags prints a warning message for a deprecated flags if they are set.
func notifyAboutDeprecatedFlags() {
	const resetColorPostfix = "\033[0m"
	logger := initWarningLogger()

	flag.Visit(func(f *flag.Flag) {
		switch f.Name {
		case deprecatedFlagProgOnly:
			logger.Println("The -prog_only flag is deprecated and has no effect.", resetColorPostfix)
		case deprecatedFlagExecOnly:
			logger.Println("The -exec_only flag is deprecated and has no effect.", resetColorPostfix)
		}
	})
}

func initWarningLogger() *log.Logger {
	const (
		yellowColor   = "\033[33m"
		warningPrefix = yellowColor + "WARNING: "
	)

	return log.New(os.Stdout, warningPrefix, log.Ldate|log.Ltime)
}
